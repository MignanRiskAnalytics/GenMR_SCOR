

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tutorial 2: Implementing perils in the GenMR digital template &mdash; GenMR 1.1.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=58fbf978"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Tutorial 1: Generating a virtual environment for the GenMR digital template" href="Tutorial1_DigitalTemplate_environment.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            GenMR
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../rationale.html">Rationale</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../rationale.html#compound-events">Compound events</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rationale.html#generic-multi-risk-genmr-framework">Generic Multi-Risk (GenMR) framework</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../rationale.html#past-developments">Past developments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rationale.html#new-developments">New developments</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../rationale.html#digital-template">Digital Template</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../rationale.html#id18">Past developments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rationale.html#id26">New developments</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../rationale.html#tutorials">Tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rationale.html#how-to-guides">How-to guides</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rationale.html#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../manual.html">Reference manual</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../manual.html#module-GenMR.environment">GenMR.environment module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#genmr-virtual-environment-generator">GenMR Virtual Environment Generator</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#layers-and-related-objects-v1-1-1">Layers and Related Objects (v1.1.1)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#layers-and-related-objects-v1-1-2">Layers and Related Objects (v1.1.2)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#planned-additions-v1-1-2">Planned Additions (v1.1.2)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.environment.CriticalInfrastructure"><code class="docutils literal notranslate"><span class="pre">CriticalInfrastructure</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.CriticalInfrastructure.Ex_S_kton"><code class="docutils literal notranslate"><span class="pre">CriticalInfrastructure.Ex_S_kton</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.CriticalInfrastructure.area"><code class="docutils literal notranslate"><span class="pre">CriticalInfrastructure.area</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.CriticalInfrastructure.centroid"><code class="docutils literal notranslate"><span class="pre">CriticalInfrastructure.centroid</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.CriticalInfrastructure.distance_to_coast"><code class="docutils literal notranslate"><span class="pre">CriticalInfrastructure.distance_to_coast</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.CriticalInfrastructure.distance_to_river"><code class="docutils literal notranslate"><span class="pre">CriticalInfrastructure.distance_to_river</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.CriticalInfrastructure.name"><code class="docutils literal notranslate"><span class="pre">CriticalInfrastructure.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.CriticalInfrastructure.polygon"><code class="docutils literal notranslate"><span class="pre">CriticalInfrastructure.polygon</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.CriticalInfrastructure.zone_type"><code class="docutils literal notranslate"><span class="pre">CriticalInfrastructure.zone_type</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_atmo"><code class="docutils literal notranslate"><span class="pre">EnvLayer_atmo</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_atmo.ID"><code class="docutils literal notranslate"><span class="pre">EnvLayer_atmo.ID</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_atmo.topo"><code class="docutils literal notranslate"><span class="pre">EnvLayer_atmo.topo</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_atmo.par"><code class="docutils literal notranslate"><span class="pre">EnvLayer_atmo.par</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_atmo.grid"><code class="docutils literal notranslate"><span class="pre">EnvLayer_atmo.grid</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_atmo.T0"><code class="docutils literal notranslate"><span class="pre">EnvLayer_atmo.T0</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_atmo.T"><code class="docutils literal notranslate"><span class="pre">EnvLayer_atmo.T</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_atmo.calc_T0_EBCM"><code class="docutils literal notranslate"><span class="pre">EnvLayer_atmo.calc_T0_EBCM()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_atmo.calc_T_z"><code class="docutils literal notranslate"><span class="pre">EnvLayer_atmo.calc_T_z()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_atmo.calc_p_hydrostatic"><code class="docutils literal notranslate"><span class="pre">EnvLayer_atmo.calc_p_hydrostatic()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_atmo.calc_z_freeze"><code class="docutils literal notranslate"><span class="pre">EnvLayer_atmo.calc_z_freeze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_atmo.calc_z_tropopause"><code class="docutils literal notranslate"><span class="pre">EnvLayer_atmo.calc_z_tropopause()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_atmo.z_freezinglevel"><code class="docutils literal notranslate"><span class="pre">EnvLayer_atmo.z_freezinglevel</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_atmo.z_tropopause"><code class="docutils literal notranslate"><span class="pre">EnvLayer_atmo.z_tropopause</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_natLand"><code class="docutils literal notranslate"><span class="pre">EnvLayer_natLand</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_natLand.ID"><code class="docutils literal notranslate"><span class="pre">EnvLayer_natLand.ID</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_natLand.soil"><code class="docutils literal notranslate"><span class="pre">EnvLayer_natLand.soil</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_natLand.grid"><code class="docutils literal notranslate"><span class="pre">EnvLayer_natLand.grid</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_natLand.topo"><code class="docutils literal notranslate"><span class="pre">EnvLayer_natLand.topo</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_natLand.src"><code class="docutils literal notranslate"><span class="pre">EnvLayer_natLand.src</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_natLand.par"><code class="docutils literal notranslate"><span class="pre">EnvLayer_natLand.par</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_natLand.S"><code class="docutils literal notranslate"><span class="pre">EnvLayer_natLand.S</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_natLand.hW"><code class="docutils literal notranslate"><span class="pre">EnvLayer_natLand.hW</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_soil"><code class="docutils literal notranslate"><span class="pre">EnvLayer_soil</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_soil.ID"><code class="docutils literal notranslate"><span class="pre">EnvLayer_soil.ID</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_soil.topo"><code class="docutils literal notranslate"><span class="pre">EnvLayer_soil.topo</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_soil.par"><code class="docutils literal notranslate"><span class="pre">EnvLayer_soil.par</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_soil.grid"><code class="docutils literal notranslate"><span class="pre">EnvLayer_soil.grid</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_soil.h"><code class="docutils literal notranslate"><span class="pre">EnvLayer_soil.h</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_soil.hw"><code class="docutils literal notranslate"><span class="pre">EnvLayer_soil.hw</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_soil.FS_state"><code class="docutils literal notranslate"><span class="pre">EnvLayer_soil.FS_state</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_soil.FS_value"><code class="docutils literal notranslate"><span class="pre">EnvLayer_soil.FS_value</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_soil.wetness"><code class="docutils literal notranslate"><span class="pre">EnvLayer_soil.wetness</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_topo"><code class="docutils literal notranslate"><span class="pre">EnvLayer_topo</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_topo.ID"><code class="docutils literal notranslate"><span class="pre">EnvLayer_topo.ID</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_topo.src"><code class="docutils literal notranslate"><span class="pre">EnvLayer_topo.src</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_topo.grid"><code class="docutils literal notranslate"><span class="pre">EnvLayer_topo.grid</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_topo.par"><code class="docutils literal notranslate"><span class="pre">EnvLayer_topo.par</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_topo.z"><code class="docutils literal notranslate"><span class="pre">EnvLayer_topo.z</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_topo.gridlow"><code class="docutils literal notranslate"><span class="pre">EnvLayer_topo.gridlow</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_topo.algo_diamondsquare"><code class="docutils literal notranslate"><span class="pre">EnvLayer_topo.algo_diamondsquare()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_topo.aspect"><code class="docutils literal notranslate"><span class="pre">EnvLayer_topo.aspect</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_topo.coastline_coord"><code class="docutils literal notranslate"><span class="pre">EnvLayer_topo.coastline_coord</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_topo.model_cs_compoundbevel"><code class="docutils literal notranslate"><span class="pre">EnvLayer_topo.model_cs_compoundbevel()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_topo.model_fr_diamondsquare"><code class="docutils literal notranslate"><span class="pre">EnvLayer_topo.model_fr_diamondsquare()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_topo.model_rv_dampedsine"><code class="docutils literal notranslate"><span class="pre">EnvLayer_topo.model_rv_dampedsine()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_topo.model_th_ellipsoid"><code class="docutils literal notranslate"><span class="pre">EnvLayer_topo.model_th_ellipsoid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_topo.model_vo_cone"><code class="docutils literal notranslate"><span class="pre">EnvLayer_topo.model_vo_cone()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_topo.river_coord"><code class="docutils literal notranslate"><span class="pre">EnvLayer_topo.river_coord</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_topo.slope"><code class="docutils literal notranslate"><span class="pre">EnvLayer_topo.slope</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_urbLand"><code class="docutils literal notranslate"><span class="pre">EnvLayer_urbLand</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_urbLand.ID"><code class="docutils literal notranslate"><span class="pre">EnvLayer_urbLand.ID</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_urbLand.grid"><code class="docutils literal notranslate"><span class="pre">EnvLayer_urbLand.grid</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_urbLand.topo"><code class="docutils literal notranslate"><span class="pre">EnvLayer_urbLand.topo</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_urbLand.par"><code class="docutils literal notranslate"><span class="pre">EnvLayer_urbLand.par</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_urbLand.S"><code class="docutils literal notranslate"><span class="pre">EnvLayer_urbLand.S</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_urbLand.year"><code class="docutils literal notranslate"><span class="pre">EnvLayer_urbLand.year</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_urbLand.urban_yes"><code class="docutils literal notranslate"><span class="pre">EnvLayer_urbLand.urban_yes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_urbLand.disp_val"><code class="docutils literal notranslate"><span class="pre">EnvLayer_urbLand.disp_val</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_urbLand.max_roadsearch"><code class="docutils literal notranslate"><span class="pre">EnvLayer_urbLand.max_roadsearch</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_urbLand.roadNet"><code class="docutils literal notranslate"><span class="pre">EnvLayer_urbLand.roadNet</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_urbLand.built"><code class="docutils literal notranslate"><span class="pre">EnvLayer_urbLand.built</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_urbLand.roads"><code class="docutils literal notranslate"><span class="pre">EnvLayer_urbLand.roads</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_urbLand.built_type"><code class="docutils literal notranslate"><span class="pre">EnvLayer_urbLand.built_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_urbLand.built_yr"><code class="docutils literal notranslate"><span class="pre">EnvLayer_urbLand.built_yr</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_urbLand.CI_refinery"><code class="docutils literal notranslate"><span class="pre">EnvLayer_urbLand.CI_refinery</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_urbLand.bldg_roofpitch"><code class="docutils literal notranslate"><span class="pre">EnvLayer_urbLand.bldg_roofpitch</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_urbLand.bldg_type"><code class="docutils literal notranslate"><span class="pre">EnvLayer_urbLand.bldg_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_urbLand.bldg_value"><code class="docutils literal notranslate"><span class="pre">EnvLayer_urbLand.bldg_value</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_urbLand.calc_Pr_urbanise"><code class="docutils literal notranslate"><span class="pre">EnvLayer_urbLand.calc_Pr_urbanise()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_urbLand.get_S_urban"><code class="docutils literal notranslate"><span class="pre">EnvLayer_urbLand.get_S_urban()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_urbLand.get_d4mkd"><code class="docutils literal notranslate"><span class="pre">EnvLayer_urbLand.get_d4mkd()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_urbLand.get_industrialZones"><code class="docutils literal notranslate"><span class="pre">EnvLayer_urbLand.get_industrialZones()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_urbLand.get_state_built"><code class="docutils literal notranslate"><span class="pre">EnvLayer_urbLand.get_state_built()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_urbLand.industrialZones"><code class="docutils literal notranslate"><span class="pre">EnvLayer_urbLand.industrialZones</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_urbLand.roadNet_coord"><code class="docutils literal notranslate"><span class="pre">EnvLayer_urbLand.roadNet_coord</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvLayer_urbLand.transform_landUse"><code class="docutils literal notranslate"><span class="pre">EnvLayer_urbLand.transform_landUse()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.environment.EnvObj_roadNetwork"><code class="docutils literal notranslate"><span class="pre">EnvObj_roadNetwork</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvObj_roadNetwork.topo"><code class="docutils literal notranslate"><span class="pre">EnvObj_roadNetwork.topo</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvObj_roadNetwork.land"><code class="docutils literal notranslate"><span class="pre">EnvObj_roadNetwork.land</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvObj_roadNetwork.par"><code class="docutils literal notranslate"><span class="pre">EnvObj_roadNetwork.par</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvObj_roadNetwork.grid"><code class="docutils literal notranslate"><span class="pre">EnvObj_roadNetwork.grid</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvObj_roadNetwork.net"><code class="docutils literal notranslate"><span class="pre">EnvObj_roadNetwork.net</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvObj_roadNetwork.Rmax"><code class="docutils literal notranslate"><span class="pre">EnvObj_roadNetwork.Rmax</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvObj_roadNetwork.mask"><code class="docutils literal notranslate"><span class="pre">EnvObj_roadNetwork.mask</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvObj_roadNetwork.S"><code class="docutils literal notranslate"><span class="pre">EnvObj_roadNetwork.S</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvObj_roadNetwork.id"><code class="docutils literal notranslate"><span class="pre">EnvObj_roadNetwork.id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvObj_roadNetwork.eps"><code class="docutils literal notranslate"><span class="pre">EnvObj_roadNetwork.eps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.environment.EnvObj_roadNetwork.nodeID"><code class="docutils literal notranslate"><span class="pre">EnvObj_roadNetwork.nodeID</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.environment.RasterGrid"><code class="docutils literal notranslate"><span class="pre">RasterGrid</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.environment.calc_FS"><code class="docutils literal notranslate"><span class="pre">calc_FS()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.environment.calc_coord_river_dampedsine"><code class="docutils literal notranslate"><span class="pre">calc_coord_river_dampedsine()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.environment.calc_topo_attributes"><code class="docutils literal notranslate"><span class="pre">calc_topo_attributes()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.environment.downscale_RasterGrid"><code class="docutils literal notranslate"><span class="pre">downscale_RasterGrid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.environment.get_FS_state"><code class="docutils literal notranslate"><span class="pre">get_FS_state()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.environment.plot_EnvLayer_attr"><code class="docutils literal notranslate"><span class="pre">plot_EnvLayer_attr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.environment.plot_EnvLayers"><code class="docutils literal notranslate"><span class="pre">plot_EnvLayers()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../manual.html#module-GenMR.perils">GenMR.perils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#genmr-peril-implementation">GenMR Peril Implementation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#peril-models-v1-1-1">Peril models (v1.1.1)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#peril-models-v1-1-2">Peril models (v1.1.2)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#planned-peril-models-v1-1-2">Planned peril models (v1.1.2)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.perils.CellularAutomaton_FF"><code class="docutils literal notranslate"><span class="pre">CellularAutomaton_FF</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.perils.CellularAutomaton_FF.result"><code class="docutils literal notranslate"><span class="pre">CellularAutomaton_FF.result()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.perils.CellularAutomaton_FF.run"><code class="docutils literal notranslate"><span class="pre">CellularAutomaton_FF.run()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.perils.CellularAutomaton_FF.write_gif"><code class="docutils literal notranslate"><span class="pre">CellularAutomaton_FF.write_gif()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.perils.CellularAutomaton_LS"><code class="docutils literal notranslate"><span class="pre">CellularAutomaton_LS</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.perils.CellularAutomaton_LS.result"><code class="docutils literal notranslate"><span class="pre">CellularAutomaton_LS.result()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.perils.CellularAutomaton_LS.run"><code class="docutils literal notranslate"><span class="pre">CellularAutomaton_LS.run()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.perils.CellularAutomaton_LS.write_gif"><code class="docutils literal notranslate"><span class="pre">CellularAutomaton_LS.write_gif()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.perils.CellularAutomaton_WF"><code class="docutils literal notranslate"><span class="pre">CellularAutomaton_WF</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.perils.CellularAutomaton_WF.run"><code class="docutils literal notranslate"><span class="pre">CellularAutomaton_WF.run()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.perils.DynamicHazardFootprintGenerator"><code class="docutils literal notranslate"><span class="pre">DynamicHazardFootprintGenerator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.perils.DynamicHazardFootprintGenerator.generate"><code class="docutils literal notranslate"><span class="pre">DynamicHazardFootprintGenerator.generate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.perils.DynamicHazardFootprintGenerator.load_WF_CA_footprints"><code class="docutils literal notranslate"><span class="pre">DynamicHazardFootprintGenerator.load_WF_CA_footprints()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.perils.EventSetGenerator"><code class="docutils literal notranslate"><span class="pre">EventSetGenerator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.perils.EventSetGenerator.src"><code class="docutils literal notranslate"><span class="pre">EventSetGenerator.src</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.perils.EventSetGenerator.sizeDistr"><code class="docutils literal notranslate"><span class="pre">EventSetGenerator.sizeDistr</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.perils.EventSetGenerator.utils"><code class="docutils literal notranslate"><span class="pre">EventSetGenerator.utils</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.perils.EventSetGenerator.ev_stoch"><code class="docutils literal notranslate"><span class="pre">EventSetGenerator.ev_stoch</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.perils.EventSetGenerator.ev_char"><code class="docutils literal notranslate"><span class="pre">EventSetGenerator.ev_char</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.perils.EventSetGenerator.generate"><code class="docutils literal notranslate"><span class="pre">EventSetGenerator.generate()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.perils.HazardFootprintGenerator"><code class="docutils literal notranslate"><span class="pre">HazardFootprintGenerator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.perils.HazardFootprintGenerator.add_v_forward"><code class="docutils literal notranslate"><span class="pre">HazardFootprintGenerator.add_v_forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.perils.HazardFootprintGenerator.calc4TC_I_v_ms"><code class="docutils literal notranslate"><span class="pre">HazardFootprintGenerator.calc4TC_I_v_ms()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.perils.HazardFootprintGenerator.calc4To_I_v_ms"><code class="docutils literal notranslate"><span class="pre">HazardFootprintGenerator.calc4To_I_v_ms()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.perils.HazardFootprintGenerator.calc_I_ash_m"><code class="docutils literal notranslate"><span class="pre">HazardFootprintGenerator.calc_I_ash_m()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.perils.HazardFootprintGenerator.calc_I_blast_kPa"><code class="docutils literal notranslate"><span class="pre">HazardFootprintGenerator.calc_I_blast_kPa()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.perils.HazardFootprintGenerator.calc_I_shaking_ms2"><code class="docutils literal notranslate"><span class="pre">HazardFootprintGenerator.calc_I_shaking_ms2()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.perils.HazardFootprintGenerator.calc_S_track"><code class="docutils literal notranslate"><span class="pre">HazardFootprintGenerator.calc_S_track()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.perils.HazardFootprintGenerator.calc_lateral_distance_signed"><code class="docutils literal notranslate"><span class="pre">HazardFootprintGenerator.calc_lateral_distance_signed()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.perils.HazardFootprintGenerator.calc_v_from_EFscale"><code class="docutils literal notranslate"><span class="pre">HazardFootprintGenerator.calc_v_from_EFscale()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.perils.HazardFootprintGenerator.generate"><code class="docutils literal notranslate"><span class="pre">HazardFootprintGenerator.generate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.perils.HazardFootprintGenerator.get_HW_atloc"><code class="docutils literal notranslate"><span class="pre">HazardFootprintGenerator.get_HW_atloc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.perils.HazardFootprintGenerator.get_HW_footprint"><code class="docutils literal notranslate"><span class="pre">HazardFootprintGenerator.get_HW_footprint()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.perils.HazardFootprintGenerator.get_TC_timeshot"><code class="docutils literal notranslate"><span class="pre">HazardFootprintGenerator.get_TC_timeshot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.perils.HazardFootprintGenerator.model_HW_threshold"><code class="docutils literal notranslate"><span class="pre">HazardFootprintGenerator.model_HW_threshold()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.perils.HazardFootprintGenerator.model_SS_Bathtub"><code class="docutils literal notranslate"><span class="pre">HazardFootprintGenerator.model_SS_Bathtub()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.perils.HazardFootprintGenerator.model_To_analytical"><code class="docutils literal notranslate"><span class="pre">HazardFootprintGenerator.model_To_analytical()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.perils.HazardFootprintGenerator.pdf_T_advectivemodel"><code class="docutils literal notranslate"><span class="pre">HazardFootprintGenerator.pdf_T_advectivemodel()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.perils.HazardFootprintGenerator.sample_T_advectivemodel"><code class="docutils literal notranslate"><span class="pre">HazardFootprintGenerator.sample_T_advectivemodel()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.perils.HazardFootprintGenerator.sample_T_daily"><code class="docutils literal notranslate"><span class="pre">HazardFootprintGenerator.sample_T_daily()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.perils.RiskFootprintGenerator"><code class="docutils literal notranslate"><span class="pre">RiskFootprintGenerator</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.perils.Src"><code class="docutils literal notranslate"><span class="pre">Src</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.perils.Src.AI_char"><code class="docutils literal notranslate"><span class="pre">Src.AI_char</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.perils.Src.EQ_char"><code class="docutils literal notranslate"><span class="pre">Src.EQ_char</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.perils.Src.FF_char"><code class="docutils literal notranslate"><span class="pre">Src.FF_char</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.perils.Src.TC_char"><code class="docutils literal notranslate"><span class="pre">Src.TC_char</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.perils.Src.To_char"><code class="docutils literal notranslate"><span class="pre">Src.To_char</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../manual.html#GenMR.perils.Src.VE_char"><code class="docutils literal notranslate"><span class="pre">Src.VE_char</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.perils.calc_EQ_length2magnitude"><code class="docutils literal notranslate"><span class="pre">calc_EQ_length2magnitude()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.perils.calc_EQ_magnitude2length"><code class="docutils literal notranslate"><span class="pre">calc_EQ_magnitude2length()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.perils.calc_Lbd_GPD"><code class="docutils literal notranslate"><span class="pre">calc_Lbd_GPD()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.perils.calc_Lbd_exponential"><code class="docutils literal notranslate"><span class="pre">calc_Lbd_exponential()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.perils.calc_Lbd_powerlaw"><code class="docutils literal notranslate"><span class="pre">calc_Lbd_powerlaw()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.perils.calc_PET"><code class="docutils literal notranslate"><span class="pre">calc_PET()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.perils.calc_e0"><code class="docutils literal notranslate"><span class="pre">calc_e0()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.perils.calc_lbd_Dr"><code class="docutils literal notranslate"><span class="pre">calc_lbd_Dr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.perils.calc_qsat"><code class="docutils literal notranslate"><span class="pre">calc_qsat()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.perils.gen_precipitation"><code class="docutils literal notranslate"><span class="pre">gen_precipitation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.perils.get_Dr"><code class="docutils literal notranslate"><span class="pre">get_Dr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.perils.get_peril_evID"><code class="docutils literal notranslate"><span class="pre">get_peril_evID()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.perils.incrementing"><code class="docutils literal notranslate"><span class="pre">incrementing()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.perils.plot_hazFootprints"><code class="docutils literal notranslate"><span class="pre">plot_hazFootprints()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.perils.plot_src"><code class="docutils literal notranslate"><span class="pre">plot_src()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.perils.plot_vulnFunctions"><code class="docutils literal notranslate"><span class="pre">plot_vulnFunctions()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.perils.update_soil_moisture"><code class="docutils literal notranslate"><span class="pre">update_soil_moisture()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.perils.vuln_f"><code class="docutils literal notranslate"><span class="pre">vuln_f()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../manual.html#module-GenMR.utils">GenMR.utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#genmr-utility-functions">GenMR Utility Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.utils.calc_EP"><code class="docutils literal notranslate"><span class="pre">calc_EP()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.utils.calc_riskmetrics_fromELT"><code class="docutils literal notranslate"><span class="pre">calc_riskmetrics_fromELT()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.utils.cmap_peril"><code class="docutils literal notranslate"><span class="pre">cmap_peril()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.utils.col_peril"><code class="docutils literal notranslate"><span class="pre">col_peril()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.utils.col_state_h"><code class="docutils literal notranslate"><span class="pre">col_state_h()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.utils.fetch_A0"><code class="docutils literal notranslate"><span class="pre">fetch_A0()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.utils.get_ind_aspect2moore"><code class="docutils literal notranslate"><span class="pre">get_ind_aspect2moore()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.utils.get_ndays_inMonth"><code class="docutils literal notranslate"><span class="pre">get_ndays_inMonth()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.utils.get_neighborhood_ind"><code class="docutils literal notranslate"><span class="pre">get_neighborhood_ind()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.utils.get_net_coord"><code class="docutils literal notranslate"><span class="pre">get_net_coord()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.utils.incrementing"><code class="docutils literal notranslate"><span class="pre">incrementing()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.utils.init_io"><code class="docutils literal notranslate"><span class="pre">init_io()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.utils.load_json2dict"><code class="docutils literal notranslate"><span class="pre">load_json2dict()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.utils.load_pickle2class"><code class="docutils literal notranslate"><span class="pre">load_pickle2class()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.utils.map2upperTail"><code class="docutils literal notranslate"><span class="pre">map2upperTail()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.utils.marker_peril"><code class="docutils literal notranslate"><span class="pre">marker_peril()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.utils.norm_z"><code class="docutils literal notranslate"><span class="pre">norm_z</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.utils.partitioning"><code class="docutils literal notranslate"><span class="pre">partitioning()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.utils.pooling"><code class="docutils literal notranslate"><span class="pre">pooling()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.utils.sample_points_in_polygon"><code class="docutils literal notranslate"><span class="pre">sample_points_in_polygon()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.utils.save_class2pickle"><code class="docutils literal notranslate"><span class="pre">save_class2pickle()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.utils.save_dict2json"><code class="docutils literal notranslate"><span class="pre">save_dict2json()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual.html#GenMR.utils.zero_boundary_2d"><code class="docutils literal notranslate"><span class="pre">zero_boundary_2d()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Tutorial1_DigitalTemplate_environment.html">Tutorial 1: Environment generation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Tutorial1_DigitalTemplate_environment.html#natural-environment-generation">1. Natural environment generation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Tutorial1_DigitalTemplate_environment.html#grid-definition">1.1. Grid definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="Tutorial1_DigitalTemplate_environment.html#natural-peril-definition-for-environmental-objects">1.2. Natural peril definition (for environmental objects)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Tutorial1_DigitalTemplate_environment.html#generating-the-topography-atmosphere-soil-and-natural-land-layers">1.3. Generating the topography, atmosphere, soil, and natural land layers</a></li>
<li class="toctree-l3"><a class="reference internal" href="Tutorial1_DigitalTemplate_environment.html#environmental-layer-properties-and-attribute-plotting">1.4. Environmental layer properties (and attribute plotting)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Tutorial1_DigitalTemplate_environment.html#technological-environment-generation">2. Technological environment generation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Tutorial1_DigitalTemplate_environment.html#generating-the-urban-land-layer-and-road-network-object">2.1. Generating the urban land layer (and road network object)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Tutorial1_DigitalTemplate_environment.html#environmental-layer-properties">2.2. Environmental layer properties</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Tutorial1_DigitalTemplate_environment.html#socio-economic-environment-generation">3. Socio-economic environment generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="Tutorial1_DigitalTemplate_environment.html#references">References</a></li>
<li class="toctree-l2"><a class="reference internal" href="Tutorial1_DigitalTemplate_environment.html#appendix">Appendix</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Tutorial1_DigitalTemplate_environment.html#a-attributes-properties-of-environmental-layers">A. Attributes &amp; properties of environmental layers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Tutorial1_DigitalTemplate_environment.html#a-1-a-note-on-environmental-layer-downscaling">A.1 A note on environmental layer downscaling</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Tutorial1_DigitalTemplate_environment.html#b-underlying-physical-processes">B. Underlying physical processes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Tutorial1_DigitalTemplate_environment.html#b-1-atmospheric-layer-temperature">B.1. Atmospheric layer: Temperature</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorial 2: Peril implementation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#stochastic-event-set">1. Stochastic event set</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#peril-source-definition">1.1. Peril source definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="#event-table-generation">1.2. Event table generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#intensity-footprint-catalogue-generation">1.3. Intensity footprint catalogue generation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#from-analytical-expressions-threshold-models">1.3.1. From analytical expressions &amp; threshold models</a></li>
<li class="toctree-l4"><a class="reference internal" href="#from-numerical-models-cellular-automata">1.3.2. From numerical models (cellular automata)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#probabilistic-risk-assessment">2. Probabilistic risk assessment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#vulnerability-curve-definition">2.1. Vulnerability curve definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="#loss-footprint-catalogue-generation">2.2. Loss footprint catalogue generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#risk-metrics">2.3. Risk metrics</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
<li class="toctree-l2"><a class="reference internal" href="#appendix">Appendix</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#a-peril-sources">A. Peril sources</a></li>
<li class="toctree-l3"><a class="reference internal" href="#b-stochastic-event-set">B. Stochastic event set</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#b-1-earthquake-case">B.1. Earthquake case</a></li>
<li class="toctree-l4"><a class="reference internal" href="#b-2-lightning-case">B.2. Lightning case</a></li>
<li class="toctree-l4"><a class="reference internal" href="#b-3-tornado-case">B.3. Tornado case</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#c-hazard-footprints">C. Hazard footprints</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#c-1-tropical-cyclone-case">C.1. Tropical cyclone case</a></li>
<li class="toctree-l4"><a class="reference internal" href="#c-2-tornado-case">C.2. Tornado case</a></li>
<li class="toctree-l4"><a class="reference internal" href="#c-3-heatwave-case-threshold-model">C.3. Heatwave case (threshold model)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GenMR</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Tutorial 2: Implementing perils in the GenMR digital template</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/notebooks/Tutorial2_DigitalTemplate_perils.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="tutorial-2-implementing-perils-in-the-genmr-digital-template">
<h1>Tutorial 2: Implementing perils in the GenMR digital template<a class="headerlink" href="#tutorial-2-implementing-perils-in-the-genmr-digital-template" title="Link to this heading"></a></h1>
<p><strong>Author:</strong> Arnaud Mignan, Mignan Risk Analytics GmbH<br />
<strong>Version:</strong> 1.1.2<br />
<strong>Last Updated:</strong> 2026-01-29<br />
<strong>License:</strong> <a class="reference external" href="https://opensource.org/license/agpl-v3">AGPL-3</a></p>
<p>Once a virtual environment has been generated (see previous tutorial), stochastic events are modelled to populate it. Table 1 lists the perils included in version 1.1.2 (the ones still missing to be included by June 2026).</p>
<br>
<center><small><b>Tab. 1.</b> List of perils with identifiers (ID) according to <a href='https://www.cambridge.org/highereducation/books/introduction-to-catastrophe-risk-modelling/A3A5B5FB990921422BFEBB07734BF869#overview' target='_blank'>Mignan (2024:tab.1.7)</a>.</small></center>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-left"><p>ID</p></th>
<th class="head text-left"><p>Peril</p></th>
<th class="head text-left"><p>Peril type<sup></sup></p></th>
<th class="head text-left"><p>Source class</p></th>
<th class="head text-left"><p>Event size</p></th>
<th class="head text-left"><p>Intensity class</p></th>
<th class="head text-left"><p>Intensity measure</p></th>
<th class="head text-left"><p>Status<sup></sup></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p></p></td>
<td class="text-left"><p><strong>NATURAL</strong></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">AI</span></code></p></td>
<td class="text-left"><p>Asteroid impact</p></td>
<td class="text-left"><p>Primary</p></td>
<td class="text-left"><p>Point</p></td>
<td class="text-left"><p>Kinetic energy (kt)</p></td>
<td class="text-left"><p>Analytical</p></td>
<td class="text-left"><p>Overpressure (kPa)</p></td>
<td class="text-left"><p><span style="color: green"><span></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">CS</span></code></p></td>
<td class="text-left"><p>Convertive storm</p></td>
<td class="text-left"><p>Primary (invisible<span class="math notranslate nohighlight">\(^*\)</span>)</p></td>
<td class="text-left"><p>Area</p></td>
<td class="text-left"><p>Cloud top height (km)</p></td>
<td class="text-left"><p>Uniform</p></td>
<td class="text-left"><p>Cloud top height (km)</p></td>
<td class="text-left"><p><span style="color: green"><span></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">Dr</span></code></p></td>
<td class="text-left"><p>Drought</p></td>
<td class="text-left"><p>Primary (invisible<span class="math notranslate nohighlight">\(^*\)</span>)</p></td>
<td class="text-left"><p>Area</p></td>
<td class="text-left"><p>Duration (mon)</p></td>
<td class="text-left"><p>Threshold</p></td>
<td class="text-left"><p>Yes/no</p></td>
<td class="text-left"><p><span style="color: orange">ongoing<span></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">EQ</span></code></p></td>
<td class="text-left"><p>Earthquake</p></td>
<td class="text-left"><p>Primary</p></td>
<td class="text-left"><p>Line</p></td>
<td class="text-left"><p>Magnitude</p></td>
<td class="text-left"><p>Analytical</p></td>
<td class="text-left"><p>Peak ground acceleration (m/s<span class="math notranslate nohighlight">\(^2\)</span>)</p></td>
<td class="text-left"><p><span style="color: green"><span></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">FF</span></code></p></td>
<td class="text-left"><p>Fluvial flood</p></td>
<td class="text-left"><p>Secondary (to <code class="docutils literal notranslate"><span class="pre">RS</span></code>)</p></td>
<td class="text-left"><p>Point</p></td>
<td class="text-left"><p>Peak flow</p></td>
<td class="text-left"><p>Cellular automaton</p></td>
<td class="text-left"><p>Inundation depth (m)</p></td>
<td class="text-left"><p><span style="color: green"><span></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">HW</span></code></p></td>
<td class="text-left"><p>Heatwave</p></td>
<td class="text-left"><p>Primary (invisible<span class="math notranslate nohighlight">\(^*\)</span>)</p></td>
<td class="text-left"><p>Area</p></td>
<td class="text-left"><p>Duration (da)</p></td>
<td class="text-left"><p>Threshold</p></td>
<td class="text-left"><p>Inside/outside</p></td>
<td class="text-left"><p><span style="color: green"><span></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">Li</span></code></p></td>
<td class="text-left"><p>Lightning</p></td>
<td class="text-left"><p>Secondary (to <code class="docutils literal notranslate"><span class="pre">CS</span></code>, invisible<span class="math notranslate nohighlight">\(^*\)</span>)</p></td>
<td class="text-left"><p>Point</p></td>
<td class="text-left"><p>-</p></td>
<td class="text-left"><p>-</p></td>
<td class="text-left"><p>-</p></td>
<td class="text-left"><p><span style="color: green"><span></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">LS</span></code></p></td>
<td class="text-left"><p>Landslide</p></td>
<td class="text-left"><p>Secondary (to <code class="docutils literal notranslate"><span class="pre">RS</span></code>)</p></td>
<td class="text-left"><p>Diffuse</p></td>
<td class="text-left"><p>Area (km<span class="math notranslate nohighlight">\(^2\)</span>)</p></td>
<td class="text-left"><p>Cellular automaton</p></td>
<td class="text-left"><p>Thickness (m)</p></td>
<td class="text-left"><p><span style="color: green"><span></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">PI</span></code></p></td>
<td class="text-left"><p>Pest infestation</p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p><span style="color: orange"><span></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">RS</span></code></p></td>
<td class="text-left"><p>Rainstorm</p></td>
<td class="text-left"><p>Primary (invisible<span class="math notranslate nohighlight">\(^*\)</span>)</p></td>
<td class="text-left"><p>Area</p></td>
<td class="text-left"><p>Rain intensity (mm/hr)</p></td>
<td class="text-left"><p>Uniform</p></td>
<td class="text-left"><p>Rain intensity (mm/hr)</p></td>
<td class="text-left"><p><span style="color: green"><span></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">SS</span></code></p></td>
<td class="text-left"><p>Storm surge</p></td>
<td class="text-left"><p>Secondary (to <code class="docutils literal notranslate"><span class="pre">TC</span></code>)</p></td>
<td class="text-left"><p>Line</p></td>
<td class="text-left"><p>Coastal surge height (m)</p></td>
<td class="text-left"><p>Threshold</p></td>
<td class="text-left"><p>Inundation depth (m)</p></td>
<td class="text-left"><p><span style="color: green"><span></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">TC</span></code></p></td>
<td class="text-left"><p>Tropical cyclone</p></td>
<td class="text-left"><p>Primary</p></td>
<td class="text-left"><p>Track</p></td>
<td class="text-left"><p>Max. wind speed (m/s)</p></td>
<td class="text-left"><p>Analytical</p></td>
<td class="text-left"><p>Max. wind speed (m/s)</p></td>
<td class="text-left"><p><span style="color: green"><span></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">To</span></code></p></td>
<td class="text-left"><p>Tornado</p></td>
<td class="text-left"><p>Primary</p></td>
<td class="text-left"><p>Line</p></td>
<td class="text-left"><p>Enhanced Fujita (EF) scale</p></td>
<td class="text-left"><p>Analytical</p></td>
<td class="text-left"><p>Max. wind speed (m/s)</p></td>
<td class="text-left"><p><span style="color: green"><span></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">VE</span></code></p></td>
<td class="text-left"><p>Volcanic eruption</p></td>
<td class="text-left"><p>Primary</p></td>
<td class="text-left"><p>Point</p></td>
<td class="text-left"><p>Volume erupted (km<span class="math notranslate nohighlight">\(^3\)</span>)</p></td>
<td class="text-left"><p>Analytical</p></td>
<td class="text-left"><p>Ash load (kPa)</p></td>
<td class="text-left"><p><span style="color: green"><span></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">WF</span></code></p></td>
<td class="text-left"><p>Wildfire</p></td>
<td class="text-left"><p>Primary</p></td>
<td class="text-left"><p>Diffuse</p></td>
<td class="text-left"><p>Burnt area</p></td>
<td class="text-left"><p>Cellular automaton</p></td>
<td class="text-left"><p>Burnt/not burnt</p></td>
<td class="text-left"><p><span style="color: green"><span></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">WS</span></code></p></td>
<td class="text-left"><p>Windstorm</p></td>
<td class="text-left"><p>Primary</p></td>
<td class="text-left"><p>Area</p></td>
<td class="text-left"><p>Max. wind speed (m/s)</p></td>
<td class="text-left"><p>Uniform</p></td>
<td class="text-left"><p>Max. wind speed (m/s)</p></td>
<td class="text-left"><p><span style="color: green"><span></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p></p></td>
<td class="text-left"><p><strong>TECHNOLOGICAL</strong></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">BO</span></code></p></td>
<td class="text-left"><p>Blackout</p></td>
<td class="text-left"><p>Secondary (to <code class="docutils literal notranslate"><span class="pre">dg</span></code>)</p></td>
<td class="text-left"><p>Diffuse (network)</p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p><span style="color: orange"><span></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">Ex</span></code></p></td>
<td class="text-left"><p>Explosion (industrial)</p></td>
<td class="text-left"><p>Secondary (to <code class="docutils literal notranslate"><span class="pre">dg</span></code>)</p></td>
<td class="text-left"><p>Point</p></td>
<td class="text-left"><p>TNT mass (kt)</p></td>
<td class="text-left"><p>Analytical</p></td>
<td class="text-left"><p>Overpressure <span class="math notranslate nohighlight">\(P\)</span> (kPa)</p></td>
<td class="text-left"><p><span style="color: green"><span></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p></p></td>
<td class="text-left"><p><strong>SOCIO-ECONOMIC</strong></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">BI</span></code></p></td>
<td class="text-left"><p>Business interruption</p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p><span style="color: orange"><span></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">Sf</span></code></p></td>
<td class="text-left"><p>Public service failure</p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p><span style="color: orange"><span></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">SU</span></code></p></td>
<td class="text-left"><p>Social unrest</p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p><span style="color: orange"><span></p></td>
</tr>
</tbody>
</table>
<p><small><span class="math notranslate nohighlight">\(^*\)</span> An event that does not cause any direct damage, at least in the present framework (following <a href='https://link.springer.com/article/10.1007/s11069-014-1178-4' target='_blank'>Mignan et al., 2014</a>). Still implemented as triggering mechanism.<br>
<sup></sup> Most perils are considered primary perils in this tutorial for sake of simplicity. Several will be considered secondary perils in Tutorial 3.<br>
<sup></sup> Included in current version (<span style="color: green"></span>), planned for v.1.1.2 (<span style="color: orange"></span>).</small></p>
<p>This tutorial is divided into two main sections. The first introduces the definition of peril sources, an event table (containing each events identifier and annual rate), and a corresponding catalogue of hazard-intensity footprints. The second section covers probabilistic risk assessment, in which damage and loss footprints are generated for each event identifier (Fig. 1) and risk metrics are calculated. Before beginning these sections, the digital-template environment created in the previous tutorial is loaded.</p>
<figure class="align-center" id="fig-digitaltemplate">
<a class="reference internal image-reference" href="../_images/digitaltemplate_ev_rayshader.png"><img alt="../_images/digitaltemplate_ev_rayshader.png" src="../_images/digitaltemplate_ev_rayshader.png" style="width: 500px;" />
</a>
<figcaption>
<p><span class="caption-text"><strong>Fig. 1.</strong> One instance of the GenMR digital template (default parameterisation) with an example of event hazard intensity footprint and loss footprint (here for a large earthquake). Simulation rendered using <a class="reference external" href="https://www.rayshader.com/">Rayshader</a> (Morgan-Wall, 2022).</span><a class="headerlink" href="#fig-digitaltemplate" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">copy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span> 
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>   <span class="c1"># commented, try to remove all warnings</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">GenMR</span><span class="w"> </span><span class="kn">import</span> <span class="n">perils</span> <span class="k">as</span> <span class="n">GenMR_perils</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">GenMR</span><span class="w"> </span><span class="kn">import</span> <span class="n">environment</span> <span class="k">as</span> <span class="n">GenMR_env</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">GenMR</span><span class="w"> </span><span class="kn">import</span> <span class="n">utils</span> <span class="k">as</span> <span class="n">GenMR_utils</span>


<span class="c1"># load inputs (i.e., outputs from Tutorial 1)</span>
<span class="n">file_src</span> <span class="o">=</span> <span class="s1">&#39;src.pkl&#39;</span>
<span class="n">file_topoLayer</span> <span class="o">=</span> <span class="s1">&#39;envLayer_topo.pkl&#39;</span>
<span class="n">file_atmoLayer</span> <span class="o">=</span> <span class="s1">&#39;envLayer_atmo.pkl&#39;</span>
<span class="n">file_soilLayer</span> <span class="o">=</span> <span class="s1">&#39;envLayer_soil.pkl&#39;</span>
<span class="n">file_urbLandLayer</span> <span class="o">=</span> <span class="s1">&#39;envLayer_urbLand.pkl&#39;</span>
<span class="n">src</span> <span class="o">=</span> <span class="n">GenMR_utils</span><span class="o">.</span><span class="n">load_pickle2class</span><span class="p">(</span><span class="s1">&#39;/io/&#39;</span> <span class="o">+</span> <span class="n">file_src</span><span class="p">)</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">grid</span><span class="p">)</span>
<span class="n">topoLayer</span> <span class="o">=</span> <span class="n">GenMR_utils</span><span class="o">.</span><span class="n">load_pickle2class</span><span class="p">(</span><span class="s1">&#39;/io/&#39;</span> <span class="o">+</span> <span class="n">file_topoLayer</span><span class="p">)</span>
<span class="n">atmoLayer</span> <span class="o">=</span> <span class="n">GenMR_utils</span><span class="o">.</span><span class="n">load_pickle2class</span><span class="p">(</span><span class="s1">&#39;/io/&#39;</span> <span class="o">+</span> <span class="n">file_atmoLayer</span><span class="p">)</span>
<span class="n">soilLayer</span> <span class="o">=</span> <span class="n">GenMR_utils</span><span class="o">.</span><span class="n">load_pickle2class</span><span class="p">(</span><span class="s1">&#39;/io/&#39;</span> <span class="o">+</span> <span class="n">file_soilLayer</span><span class="p">)</span>
<span class="n">urbLandLayer</span> <span class="o">=</span> <span class="n">GenMR_utils</span><span class="o">.</span><span class="n">load_pickle2class</span><span class="p">(</span><span class="s1">&#39;/io/&#39;</span> <span class="o">+</span> <span class="n">file_urbLandLayer</span><span class="p">)</span>

<span class="n">GenMR_env</span><span class="o">.</span><span class="n">plot_EnvLayers</span><span class="p">([</span><span class="n">topoLayer</span><span class="p">,</span> <span class="n">atmoLayer</span><span class="p">,</span> <span class="n">soilLayer</span><span class="p">,</span> <span class="n">urbLandLayer</span><span class="p">],</span> <span class="n">file_ext</span> <span class="o">=</span> <span class="s1">&#39;jpg&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/0084f0f803110a2cb9da1bc7fc5f687b102448d1305b6a71e1c4337da81b38f7.png" src="../_images/0084f0f803110a2cb9da1bc7fc5f687b102448d1305b6a71e1c4337da81b38f7.png" />
</div>
</div>
<p>Note that the configuration of the digital template environment may be changed through Tutorial 1.</p>
<section id="stochastic-event-set">
<h2>1. Stochastic event set<a class="headerlink" href="#stochastic-event-set" title="Link to this heading"></a></h2>
<p>A list of stochastic events will be defined, consisting of both primary and secondary events. Because event interactions will be addressed in the next tutorial, only simple ad-hoc one-to-one interactions are introduced here to illustrate how secondary event footprints can be generated (e.g., a storm surge from a tropical cyclone or a landslide triggered by a rainstorm). Conditional probabilities of occurrence will be examined in Tutorial 3. In this tutorial, only primary events have assigned annual rates.</p>
<section id="peril-source-definition">
<h3>1.1. Peril source definition<a class="headerlink" href="#peril-source-definition" title="Link to this heading"></a></h3>
<p>Source characteristics for earthquakes, volcanic eruptions, and fluvial floods were defined in Tutorial 1, as some environmental layers depend directly on these perils. Additional peril sources are now introduced.</p>
<p><strong>WARNING:</strong> Only perils listed in <code class="docutils literal notranslate"><span class="pre">src.par['perils']</span></code> will be modelled. The following perils require long computation times (minutes to tens of minutes on the first run; subsequent runs load from cache): <code class="docutils literal notranslate"><span class="pre">Ex</span></code>, <code class="docutils literal notranslate"><span class="pre">FF</span></code>, <code class="docutils literal notranslate"><span class="pre">HW</span></code>, <code class="docutils literal notranslate"><span class="pre">LS</span></code>, <code class="docutils literal notranslate"><span class="pre">WF</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;perils&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;AI&#39;</span><span class="p">,</span><span class="s1">&#39;Dr&#39;</span><span class="p">,</span><span class="s1">&#39;EQ&#39;</span><span class="p">,</span><span class="s1">&#39;HW&#39;</span><span class="p">,</span><span class="s1">&#39;RS&#39;</span><span class="p">,</span><span class="s1">&#39;TC&#39;</span><span class="p">,</span><span class="s1">&#39;To&#39;</span><span class="p">,</span><span class="s1">&#39;VE&#39;</span><span class="p">,</span><span class="s1">&#39;WF&#39;</span><span class="p">,</span><span class="s1">&#39;WS&#39;</span><span class="p">,</span>  <span class="s1">&#39;CS&#39;</span><span class="p">,</span>  <span class="s1">&#39;FF&#39;</span><span class="p">,</span><span class="s1">&#39;Li&#39;</span><span class="p">,</span><span class="s1">&#39;LS&#39;</span><span class="p">,</span><span class="s1">&#39;SS&#39;</span><span class="p">]</span>
                    <span class="c1"># IMPORTANT: primary perils come first in src.par[&#39;perils&#39;]</span>
                    <span class="c1"># since &#39;CS&#39; depends of &#39;To&#39;, must be listed after &#39;To&#39; (i.e., CS=special peril)</span>
                    <span class="c1"># not included in this run: &#39;Ex&#39; (slow to load)</span>


<span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;rdm_seed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">42</span>      <span class="c1"># None or integer (for stochastic sources: AI, TC)</span>
<span class="k">if</span> <span class="s1">&#39;To&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;perils&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="s1">&#39;CS&#39;</span> <span class="ow">in</span> <span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;perils&#39;</span><span class="p">]:</span>
    <span class="c1"># convective storm char. depend on tornado char.</span>
    <span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;perils&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;CS&#39;</span><span class="p">)</span>

<span class="c1"># define new perils (&#39;EQ&#39;, &#39;FF&#39;, &#39;VE&#39; already initiated in Tutorial 1)</span>
<span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;AI&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;object&#39;</span><span class="p">:</span> <span class="s1">&#39;impact&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>     <span class="c1"># random uniform asteroid impacts (point sources)</span>
<span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;CS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;object&#39;</span><span class="p">:</span> <span class="s1">&#39;supercell&#39;</span><span class="p">,</span>           <span class="c1"># as trigger of lightnings and tornadoes</span>
                 <span class="s1">&#39;R_km&#39;</span><span class="p">:</span> <span class="mf">10.</span><span class="p">,</span>                     <span class="c1"># path conditioned on tornado path (better constrained)</span>
                 <span class="s1">&#39;dH_CS2tropopause_km&#39;</span><span class="p">:</span> <span class="mf">1.</span><span class="p">,</span>       <span class="c1"># distance between cloud top and tropopause (km)</span>
                 <span class="s1">&#39;lat_deg&#39;</span><span class="p">:</span> <span class="n">grid</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;lat_deg&#39;</span><span class="p">],</span>
                 <span class="s1">&#39;vforward_m/s&#39;</span><span class="p">:</span> <span class="mf">20.</span>              <span class="c1"># forward storm speed (m/s)</span>
                <span class="p">}</span>
<span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;CS&#39;</span><span class="p">][</span><span class="s1">&#39;S&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">atmoLayer</span><span class="o">.</span><span class="n">z_tropopause</span> <span class="o">-</span> <span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;CS&#39;</span><span class="p">][</span><span class="s1">&#39;dH_CS2tropopause_km&#39;</span><span class="p">]</span> <span class="c1"># size as cloud top height (km)</span>
<span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;Dr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;object&#39;</span><span class="p">:</span> <span class="s1">&#39;soil&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;hw_th&#39;</span><span class="p">:</span> <span class="mf">.1</span><span class="p">,</span>                     <span class="c1"># 10% of normal soil water content hw_fc_m</span>
                 <span class="s1">&#39;Si_mo&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>              <span class="c1"># Fixed event sizes (months) - for sake of illustration</span>
                 <span class="s1">&#39;sigmaT_yearly&#39;</span><span class="p">:</span> <span class="mf">.55</span><span class="p">,</span>            <span class="c1"># Temp. std. dev. - value from Olonscheck et al. (2021)</span>
                 <span class="s1">&#39;lat_deg&#39;</span><span class="p">:</span> <span class="n">grid</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;lat_deg&#39;</span><span class="p">]}</span>
<span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;HW&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;object&#39;</span><span class="p">:</span> <span class="s1">&#39;atmosphere&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;T_th&#39;</span><span class="p">:</span> <span class="mf">35.</span><span class="p">,</span>                     <span class="c1"># Minimum temperature threshold (C)</span>
                 <span class="s1">&#39;Dt_da&#39;</span><span class="p">:</span> <span class="mf">3.</span><span class="p">,</span>                     <span class="c1"># Minimum duration (days)</span>
                 <span class="s1">&#39;Si_da&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>            <span class="c1"># Fixed event sizes (days) - for sake of illustration</span>
                 <span class="s1">&#39;sigmaT_yearly&#39;</span><span class="p">:</span> <span class="mf">.55</span><span class="p">,</span>            <span class="c1"># Temp. std. dev. - value from Olonscheck et al. (2021)</span>
                 <span class="s1">&#39;sigmaT_daily&#39;</span><span class="p">:</span> <span class="mf">2.</span><span class="p">,</span>              <span class="c1"># Temp. std. dev. - value to be confirmed</span>
                 <span class="s1">&#39;corrT&#39;</span><span class="p">:</span> <span class="mf">.8</span><span class="p">,</span>                     <span class="c1"># Correlation coeff. of AR(1) process for daily temp. (val. TBC)</span>
                 <span class="s1">&#39;Dt_max_da&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>                 <span class="c1"># for Tutorial 2: HW defined over a month max</span>
                 <span class="s1">&#39;lat_deg&#39;</span><span class="p">:</span> <span class="n">grid</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;lat_deg&#39;</span><span class="p">]}</span>
<span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;Li&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;object&#39;</span><span class="p">:</span> <span class="s1">&#39;supercell&#39;</span><span class="p">}</span>
<span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;LS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;object&#39;</span><span class="p">:</span> <span class="s1">&#39;terrain&#39;</span><span class="p">}</span>
<span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;RS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;object&#39;</span><span class="p">:</span> <span class="s1">&#39;atmosphere&#39;</span><span class="p">,</span>          <span class="c1"># as trigger of landslides</span>
                 <span class="s1">&#39;duration&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">}</span>                  <span class="c1"># (hr) to calc. soil wetness that triggers LS &amp; FF discharge</span>
                                                  <span class="c1"># WARNING: constant for now, to be improved</span>

<span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;SS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;object&#39;</span><span class="p">:</span> <span class="s1">&#39;coastline&#39;</span><span class="p">}</span>
<span class="n">SS_src_xi</span><span class="p">,</span> <span class="n">SS_src_yi</span> <span class="o">=</span> <span class="n">topoLayer</span><span class="o">.</span><span class="n">coastline_coord</span>
<span class="n">src</span><span class="o">.</span><span class="n">SS_char</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">SS_src_xi</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">SS_src_yi</span><span class="p">}</span>

<span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;TC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;object&#39;</span><span class="p">:</span> <span class="s1">&#39;stormtrack&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>  <span class="c1"># pseudo-random track sources moving from West to East</span>
                 <span class="s1">&#39;npt&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>      <span class="c1"># number of points along track, which crosses the grid from West to East</span>
                 <span class="s1">&#39;max_dev&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>   <span class="c1"># random uniform deviation along the y-axis at each track point</span>
                 <span class="s1">&#39;bin_km&#39;</span><span class="p">:</span> <span class="mf">1.</span><span class="p">}</span>   <span class="c1"># track spatial resolution</span>

<span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;To&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;object&#39;</span><span class="p">:</span> <span class="s1">&#39;vortexline&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span>  <span class="c1"># random uniform vortex-line initiation points</span>
                 <span class="s1">&#39;seed_xmax&#39;</span><span class="p">:</span> <span class="mf">30.</span><span class="p">,</span>                <span class="c1"># initiates within [xmin+xbuffer, seed_xmax], i.e. warmer area</span>
                 <span class="s1">&#39;thetaE_sigma&#39;</span><span class="p">:</span> <span class="mf">15.</span><span class="p">,</span>             <span class="c1"># pathline angle std dev. </span>
                 <span class="c1"># beta distributions for stoch. line lengths function of EF size (3 defined: EF-3, EF-4, EF-5)</span>
                 <span class="s1">&#39;L_alpha_beta_Lmax_EF3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">.744</span><span class="p">,</span> <span class="mf">2.87</span><span class="p">,</span> <span class="mf">100.</span><span class="p">],</span>
                 <span class="s1">&#39;L_alpha_beta_Lmax_EF4&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.077</span><span class="p">,</span> <span class="mf">2.36</span><span class="p">,</span> <span class="mf">100.</span><span class="p">],</span>
                 <span class="s1">&#39;L_alpha_beta_Lmax_EF5&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.222</span><span class="p">,</span> <span class="mf">1.767</span><span class="p">,</span> <span class="mf">100.</span><span class="p">],</span>
                 <span class="s1">&#39;bin_km&#39;</span><span class="p">:</span> <span class="mf">1.</span><span class="p">}</span>   <span class="c1"># line spatial resolution</span>

<span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;WF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;object&#39;</span><span class="p">:</span> <span class="s1">&#39;forest&#39;</span><span class="p">}</span>
<span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;WS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;object&#39;</span><span class="p">:</span> <span class="s1">&#39;atmosphere&#39;</span><span class="p">}</span>          <span class="c1"># area source instead of track source due to lack of simple model</span>
                                                  <span class="c1"># constant vmax for all (x,y) reasonable because grid small</span>

<span class="c1"># WARNING: slow the first time it is called:</span>
<span class="c1">#CI_x, CI_y = urbLandLayer.CI_refinery.centroid</span>
<span class="c1">#src.par[&#39;Ex&#39;] = {&#39;object&#39;: &#39;refinery&#39;, &#39;N&#39;: 1, &#39;x&#39;: CI_x, &#39;y&#39;: CI_y}  # harbor refinery as source of explosions</span>


<span class="n">GenMR_perils</span><span class="o">.</span><span class="n">plot_src</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">hillshading_z</span> <span class="o">=</span> <span class="n">topoLayer</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">file_ext</span> <span class="o">=</span> <span class="s1">&#39;jpg&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b1b15f50444a0c18bfbd4601ab6e10294a67b3aae4f4c6255a4a85e412cc1daf.png" src="../_images/b1b15f50444a0c18bfbd4601ab6e10294a67b3aae4f4c6255a4a85e412cc1daf.png" />
</div>
</div>
<p><strong>NOTE:</strong> Hazard intensity footprints are modeled based on the sources shown in the map above. For stochastic sources (<code class="docutils literal notranslate"><span class="pre">AI</span></code>, <code class="docutils literal notranslate"><span class="pre">TC</span></code>, <code class="docutils literal notranslate"><span class="pre">To</span></code>), rerunning the previous cell will produce different configurations unless <code class="docutils literal notranslate"><span class="pre">rdm_seed</span></code> is fixed. For <code class="docutils literal notranslate"><span class="pre">To</span></code>, the full stochastic source (line) can only be parameterised in <code class="docutils literal notranslate"><span class="pre">EventSetGenerator()</span></code> since its length depends on the event size distribution.</p>
</section>
<section id="event-table-generation">
<h3>1.2. Event table generation<a class="headerlink" href="#event-table-generation" title="Link to this heading"></a></h3>
<p>The stochastic event set (or event table) consists of a list of events per peril, with identifier <code class="docutils literal notranslate"><span class="pre">evID</span></code>, size <code class="docutils literal notranslate"><span class="pre">S</span></code>, and rate <span class="math notranslate nohighlight">\(\lambda\)</span> (<code class="docutils literal notranslate"><span class="pre">lbd</span></code>). Two types of perils are considered: primary perils for which the rate of occurrence must be assessed and secondary perils which will be assumed in this tutorial to occur in pair with their triggers (with rate <code class="docutils literal notranslate"><span class="pre">NaN</span></code> - for conditional probabilities, see the future Tutorial 3):</p>
<ul class="simple">
<li><p>Primary perils: <code class="docutils literal notranslate"><span class="pre">AI</span></code>, <code class="docutils literal notranslate"><span class="pre">EQ</span></code>, <code class="docutils literal notranslate"><span class="pre">RS</span></code>, <code class="docutils literal notranslate"><span class="pre">TC</span></code>, <code class="docutils literal notranslate"><span class="pre">To</span></code>, <code class="docutils literal notranslate"><span class="pre">VE</span></code>, <code class="docutils literal notranslate"><span class="pre">WF</span></code>, <code class="docutils literal notranslate"><span class="pre">WS</span></code>.</p></li>
<li><p>Special perils: <code class="docutils literal notranslate"><span class="pre">CS</span></code> (primary peril depending on characteristics of <code class="docutils literal notranslate"><span class="pre">To</span></code> secondary peril), <code class="docutils literal notranslate"><span class="pre">Dr</span></code> (rate calculated independently from <code class="docutils literal notranslate"><span class="pre">calc_lbd_Dr()</span></code>), <code class="docutils literal notranslate"><span class="pre">HW</span></code> (rate derived from intensity footprint generation)</p></li>
<li><p>Secondary perils: <code class="docutils literal notranslate"><span class="pre">Li</span></code> triggered by <code class="docutils literal notranslate"><span class="pre">CS</span></code>, <code class="docutils literal notranslate"><span class="pre">LS</span></code> and <code class="docutils literal notranslate"><span class="pre">FF</span></code> triggered by <code class="docutils literal notranslate"><span class="pre">RS</span></code>, <code class="docutils literal notranslate"><span class="pre">SS</span></code> triggered by <code class="docutils literal notranslate"><span class="pre">TC</span></code>, <code class="docutils literal notranslate"><span class="pre">Ex</span></code> triggered by damage.</p></li>
</ul>
<p>Event size distributions are parameterised in the dictionary <code class="docutils literal notranslate"><span class="pre">sizeDistr</span></code> with:</p>
<ul class="simple">
<li><p>Event size incrementation according <code class="docutils literal notranslate"><span class="pre">Smin</span></code>, <code class="docutils literal notranslate"><span class="pre">Smax</span></code> and <code class="docutils literal notranslate"><span class="pre">Sbin</span></code> with binning in <code class="docutils literal notranslate"><span class="pre">linear</span></code> or <code class="docutils literal notranslate"><span class="pre">log</span></code> scale.</p></li>
<li><p>Event size distribution modelled by one of 3 functions: power-law (<code class="docutils literal notranslate"><span class="pre">powerlaw</span></code>, Mignan, 2024:eq. 2.38), exponential law (<code class="docutils literal notranslate"><span class="pre">exponential</span></code>, Mignan, 2024:eq. 2.39), or Generalised Pareto Distribution (<code class="docutils literal notranslate"><span class="pre">GPD</span></code>, Mignan, 2024:eq. 2.50).</p></li>
<li><p>Rates of the digital template are for most perils simply calibrated by taking the ratio of the region area to the area used to obtain event productivity parameters in the Mignan (2024) textbook (e.g., global or continental United States, CONUS). This is a simplification assuming a homogeneous spatial distribution of events but is used as a straightforward way to define rates for the present virtual region. Contradictions may also arise, such as between tropical cyclones (TC) and windstorms (WS), which are not expected to occur within the same latitude range. However, the purpose of this tutorial is to define and illustrate all possible perils. The mutual exclusivity of TC and WS in the same region will be addressed in Tutorial 3. If you wish to avoid this issue in the current tutorial, simply remove either <code class="docutils literal notranslate"><span class="pre">TC</span></code> or <code class="docutils literal notranslate"><span class="pre">WS</span></code> from <code class="docutils literal notranslate"><span class="pre">sizedistr['primary']</span></code> - <em>possible improvement: include latitude dependence of peril rate</em>).</p></li>
</ul>
<p>All calculations take place in the <code class="docutils literal notranslate"><span class="pre">EventSetGenerator()</span></code> class.</p>
<p><strong>NOTE 1:</strong> The maximum possible event size, <code class="docutils literal notranslate"><span class="pre">Smax</span></code>, is defined by the user for all perils except earthquakes. For earthquakes, the maximum magnitude is constrained by the maximum fault length (<code class="docutils literal notranslate"><span class="pre">src.EQ_char['srcMmax']</span></code>) according to an empirical relationship (Mignan, 2024:fig. 2.6b).</p>
<p><strong>NOTE 2:</strong> A floating rupture approach is used to generate earthquake ruptures on existing fault segments. See Appendix B to visualise the stochastic ruptures created by running the next cell, and refer to the Reference Manual for details on the method.</p>
<p><strong>NOTE 3:</strong> The number of stochastic events is set equal to the number of sources when the sources themselves are stochastic (i.e., <code class="docutils literal notranslate"><span class="pre">AI</span></code>, <code class="docutils literal notranslate"><span class="pre">TC</span></code>). This number is kep very low for illustration purposes.</p>
<p><strong>NOTE 4:</strong> The rate of heatwaves (<code class="docutils literal notranslate"><span class="pre">HW</span></code>) is computed jointly with the generation of their intensity footprints, as their occurrence is governed by extremes in a stochastic spatiotemporal temperature field constrained by the atmospheric environmental layer.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">EQ_Mmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">EQ_char</span><span class="p">[</span><span class="s1">&#39;srcMmax&#39;</span><span class="p">])</span>

<span class="n">sizeDistr</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># WARNING: all src.par[&#39;perils&#39;] modelled, do not remove perils below if listed in src.par[&#39;perils&#39;]</span>
    <span class="s1">&#39;primary&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;AI&#39;</span><span class="p">,</span><span class="s1">&#39;EQ&#39;</span><span class="p">,</span><span class="s1">&#39;RS&#39;</span><span class="p">,</span><span class="s1">&#39;TC&#39;</span><span class="p">,</span><span class="s1">&#39;To&#39;</span><span class="p">,</span><span class="s1">&#39;VE&#39;</span><span class="p">,</span><span class="s1">&#39;WF&#39;</span><span class="p">,</span><span class="s1">&#39;WS&#39;</span><span class="p">],</span>
    <span class="s1">&#39;special&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;CS&#39;</span><span class="p">,</span><span class="s1">&#39;Dr&#39;</span><span class="p">,</span><span class="s1">&#39;HW&#39;</span><span class="p">],</span>
    <span class="s1">&#39;secondary&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;FF&#39;</span><span class="p">,</span><span class="s1">&#39;Li&#39;</span><span class="p">,</span><span class="s1">&#39;LS&#39;</span><span class="p">,</span><span class="s1">&#39;SS&#39;</span><span class="p">,</span> <span class="s1">&#39;Ex&#39;</span><span class="p">],</span>
    <span class="c1"># primary perils</span>
    <span class="s1">&#39;AI&#39;</span><span class="p">:{</span>
        <span class="s1">&#39;Nstoch&#39;</span><span class="p">:</span> <span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;AI&#39;</span><span class="p">][</span><span class="s1">&#39;N&#39;</span><span class="p">],</span> <span class="s1">&#39;Sunit&#39;</span><span class="p">:</span> <span class="s1">&#39;Bolide energy $E$ (kton)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Smin&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;Smax&#39;</span><span class="p">:</span> <span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;Sbin&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Sscale&#39;</span><span class="p">:</span> <span class="s1">&#39;log&#39;</span><span class="p">,</span>
        <span class="s1">&#39;distr&#39;</span><span class="p">:</span> <span class="s1">&#39;powerlaw&#39;</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">:</span> <span class="s1">&#39;global&#39;</span><span class="p">,</span> <span class="s1">&#39;a0&#39;</span><span class="p">:</span> <span class="mf">.5677</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mf">.9</span><span class="p">,</span>      <span class="c1"># see Mignan (2024:sect.2.3.1)</span>
        <span class="s1">&#39;calibration_source&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="s1">&#39;reference&#39;</span><span class="p">:</span> <span class="s1">&#39;to_add&#39;</span>
    <span class="p">},</span>
    <span class="s1">&#39;EQ&#39;</span><span class="p">:{</span>
        <span class="s1">&#39;Nstoch&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;Sunit&#39;</span><span class="p">:</span> <span class="s1">&#39;Magnitude&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Smin&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;Smax&#39;</span><span class="p">:</span> <span class="n">EQ_Mmax</span><span class="p">,</span> <span class="s1">&#39;Sbin&#39;</span><span class="p">:</span> <span class="mf">.1</span><span class="p">,</span> <span class="s1">&#39;Sscale&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
        <span class="s1">&#39;distr&#39;</span><span class="p">:</span> <span class="s1">&#39;exponential&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mf">1.</span><span class="p">,</span>         <span class="c1"># i.e., one M = a-value EQ per year (given b-value = 1)</span>
        <span class="s1">&#39;calibration_source&#39;</span><span class="p">:</span> <span class="s1">&#39;user-defined&#39;</span><span class="p">,</span>
        <span class="s1">&#39;reference&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span>
    <span class="p">},</span>
    <span class="s1">&#39;RS&#39;</span><span class="p">:{</span>
        <span class="s1">&#39;Nstoch&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;Sunit&#39;</span><span class="p">:</span> <span class="s1">&#39;Water column (mm/hr)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Smin&#39;</span><span class="p">:</span> <span class="mi">75</span><span class="p">,</span> <span class="s1">&#39;Smax&#39;</span><span class="p">:</span> <span class="mi">125</span><span class="p">,</span> <span class="s1">&#39;Sbin&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;Sscale&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
        <span class="s1">&#39;distr&#39;</span><span class="p">:</span> <span class="s1">&#39;GPD&#39;</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">:</span> <span class="s1">&#39;CONUS&#39;</span><span class="p">,</span> <span class="s1">&#39;mu&#39;</span><span class="p">:</span> <span class="mf">50.</span><span class="p">,</span> <span class="s1">&#39;xi&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">.051</span><span class="p">,</span> <span class="s1">&#39;sigma&#39;</span><span class="p">:</span> <span class="mf">11.8</span><span class="p">,</span> <span class="s1">&#39;Lbdmin0&#39;</span><span class="p">:</span> <span class="mf">522.</span><span class="p">,</span> 
            <span class="c1"># see Mignan (2024:sect.2.3.2)</span>
        <span class="s1">&#39;calibration_source&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="s1">&#39;reference&#39;</span><span class="p">:</span> <span class="s1">&#39;to_add&#39;</span>
    <span class="p">},</span>
    <span class="s1">&#39;TC&#39;</span><span class="p">:{</span>
        <span class="s1">&#39;Nstoch&#39;</span><span class="p">:</span> <span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;TC&#39;</span><span class="p">][</span><span class="s1">&#39;N&#39;</span><span class="p">],</span> <span class="s1">&#39;Sunit&#39;</span><span class="p">:</span> <span class="s1">&#39;Max. wind speed (m/s)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Smin&#39;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span> <span class="s1">&#39;Smax&#39;</span><span class="p">:</span> <span class="mi">65</span><span class="p">,</span> <span class="s1">&#39;Sbin&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;Sscale&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
        <span class="s1">&#39;distr&#39;</span><span class="p">:</span> <span class="s1">&#39;GPD&#39;</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">:</span> <span class="s1">&#39;global&#39;</span><span class="p">,</span> <span class="s1">&#39;mu&#39;</span><span class="p">:</span> <span class="mf">33.</span><span class="p">,</span> <span class="s1">&#39;xi&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">.280</span><span class="p">,</span> <span class="s1">&#39;sigma&#39;</span><span class="p">:</span> <span class="mf">17.8</span><span class="p">,</span><span class="s1">&#39;Lbdmin0&#39;</span><span class="p">:</span> <span class="mf">43.9</span><span class="p">,</span>
<span class="c1">#        , &#39;Lbdmin&#39;: .1      # overwrites Lbdmin derived from Lbdmin0 to directly choose rate(&gt;=Smin) = Lbdmin</span>
        <span class="s1">&#39;calibration_source&#39;</span><span class="p">:</span> <span class="s1">&#39;IBTrACS&#39;</span><span class="p">,</span>
        <span class="s1">&#39;reference&#39;</span><span class="p">:</span> <span class="s1">&#39;to_add&#39;</span>
    <span class="p">},</span>
    <span class="s1">&#39;To&#39;</span><span class="p">:{</span>
        <span class="s1">&#39;Nstoch&#39;</span><span class="p">:</span> <span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;To&#39;</span><span class="p">][</span><span class="s1">&#39;N&#39;</span><span class="p">],</span> <span class="s1">&#39;Sunit&#39;</span><span class="p">:</span> <span class="s1">&#39;Enhanced Fujita scale&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Smin&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;Smax&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;Sbin&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="c1"># WARNING: hardcoded, do not change, depends on &#39;L_alpha_beta_Lmax_EF*&#39;</span>
        <span class="s1">&#39;Sscale&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
        <span class="s1">&#39;distr&#39;</span><span class="p">:</span> <span class="s1">&#39;exponential&#39;</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">:</span> <span class="s1">&#39;CONUS&#39;</span><span class="p">,</span> <span class="s1">&#39;a0&#39;</span><span class="p">:</span> <span class="mf">3.6</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mf">.9</span><span class="p">,</span>
        <span class="s1">&#39;calibration_source&#39;</span><span class="p">:</span> <span class="s1">&#39;NOAA 1950-2021 tornadoes (public)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;reference&#39;</span><span class="p">:</span> <span class="s1">&#39;to_add&#39;</span>
    <span class="p">},</span>
    <span class="s1">&#39;VE&#39;</span><span class="p">:{</span>
        <span class="s1">&#39;Nstoch&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;Sunit&#39;</span><span class="p">:</span> <span class="s1">&#39;Ash volume (km$^3$)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Smin&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Smax&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;Sbin&#39;</span><span class="p">:</span> <span class="mf">.5</span><span class="p">,</span> <span class="s1">&#39;Sscale&#39;</span><span class="p">:</span> <span class="s1">&#39;log&#39;</span><span class="p">,</span>
        <span class="s1">&#39;distr&#39;</span><span class="p">:</span> <span class="s1">&#39;powerlaw&#39;</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">:</span> <span class="s1">&#39;global&#39;</span><span class="p">,</span> <span class="s1">&#39;a0&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.155</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mf">.66</span><span class="p">,</span>      <span class="c1"># see Sect. 2.3.1</span>
        <span class="s1">&#39;calibration_source&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="s1">&#39;reference&#39;</span><span class="p">:</span> <span class="s1">&#39;to_add&#39;</span>
    <span class="p">},</span>
    <span class="s1">&#39;WF&#39;</span><span class="p">:{</span>
        <span class="s1">&#39;Nstoch&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;Sunit&#39;</span><span class="p">:</span> <span class="s1">&#39;Burnt area (ha)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Smin&#39;</span><span class="p">:</span> <span class="mf">1e4</span><span class="p">,</span> <span class="s1">&#39;Smax&#39;</span><span class="p">:</span> <span class="mf">1e5</span><span class="p">,</span> <span class="s1">&#39;Sbin&#39;</span><span class="p">:</span> <span class="mf">.5</span><span class="p">,</span> <span class="s1">&#39;Sscale&#39;</span><span class="p">:</span> <span class="s1">&#39;log&#39;</span><span class="p">,</span>
        <span class="s1">&#39;distr&#39;</span><span class="p">:</span> <span class="s1">&#39;powerlaw&#39;</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">:</span> <span class="s1">&#39;global&#39;</span><span class="p">,</span> <span class="s1">&#39;a0&#39;</span><span class="p">:</span> <span class="mf">8.553</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mf">1.23</span><span class="p">,</span>      <span class="c1"># see Sect. 2.3.1</span>
        <span class="s1">&#39;calibration_source&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="s1">&#39;reference&#39;</span><span class="p">:</span> <span class="s1">&#39;to_add&#39;</span>
    <span class="p">},</span>
    <span class="s1">&#39;WS&#39;</span><span class="p">:{</span>
        <span class="s1">&#39;Nstoch&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;Sunit&#39;</span><span class="p">:</span> <span class="s1">&#39;Max. wind speed (m/s)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Smin&#39;</span><span class="p">:</span> <span class="mi">45</span><span class="p">,</span> <span class="s1">&#39;Smax&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span> <span class="s1">&#39;Sbin&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;Sscale&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
        <span class="s1">&#39;distr&#39;</span><span class="p">:</span> <span class="s1">&#39;GPD&#39;</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">:</span> <span class="s1">&#39;local&#39;</span><span class="p">,</span> <span class="s1">&#39;mu&#39;</span><span class="p">:</span> <span class="mf">17.</span><span class="p">,</span> <span class="s1">&#39;xi&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">.112</span><span class="p">,</span> <span class="s1">&#39;sigma&#39;</span><span class="p">:</span> <span class="mf">4.43</span><span class="p">,</span> <span class="s1">&#39;Lbdmin&#39;</span><span class="p">:</span> <span class="mf">163.25</span><span class="p">,</span>
        <span class="c1"># GPD params. for Brest (France) location for illustration purposes (consider making it func. of lat.)</span>
        <span class="s1">&#39;calibration_source&#39;</span><span class="p">:</span> <span class="s1">&#39;Copernicus 1986-2011 Synthetic windstorm events for Europe&#39;</span><span class="p">,</span>
        <span class="s1">&#39;reference&#39;</span><span class="p">:</span> <span class="s1">&#39;10.24381/cds.ce973f02&#39;</span>
    <span class="p">},</span>
    <span class="c1"># special perils</span>
    <span class="s1">&#39;CS&#39;</span><span class="p">:{</span>                <span class="c1"># CS triggers To but To param better constrained, backpropagating to CS</span>
        <span class="s1">&#39;Nstoch&#39;</span><span class="p">:</span> <span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;To&#39;</span><span class="p">][</span><span class="s1">&#39;N&#39;</span><span class="p">]</span>
    <span class="p">},</span>
    <span class="s1">&#39;Dr&#39;</span><span class="p">:{</span>                <span class="c1"># Dr event rates to be calculated in calc_lbd_Dr() - see next code cell</span>
        <span class="s1">&#39;Nstoch&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;Dr&#39;</span><span class="p">][</span><span class="s1">&#39;Si_mo&#39;</span><span class="p">])</span>        
    <span class="p">},</span>
    <span class="s1">&#39;HW&#39;</span><span class="p">:{</span>                <span class="c1"># HW event rates to be calculated alongside footprint generation</span>
        <span class="s1">&#39;Nstoch&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;HW&#39;</span><span class="p">][</span><span class="s1">&#39;Si_da&#39;</span><span class="p">])</span>
    <span class="p">},</span>
    <span class="c1"># secondary perils - here ad-hoc Pr(peril|trigger) = 1, see tutorial 3 for probabilistic case</span>
    <span class="s1">&#39;FF&#39;</span><span class="p">:{</span><span class="s1">&#39;trigger&#39;</span><span class="p">:</span> <span class="s1">&#39;RS&#39;</span><span class="p">},</span>
    <span class="s1">&#39;Li&#39;</span><span class="p">:{</span><span class="s1">&#39;trigger&#39;</span><span class="p">:</span> <span class="s1">&#39;CS&#39;</span><span class="p">},</span>
    <span class="s1">&#39;LS&#39;</span><span class="p">:{</span><span class="s1">&#39;trigger&#39;</span><span class="p">:</span> <span class="s1">&#39;RS&#39;</span><span class="p">},</span>
    <span class="s1">&#39;SS&#39;</span><span class="p">:{</span><span class="s1">&#39;trigger&#39;</span><span class="p">:</span> <span class="s1">&#39;TC&#39;</span><span class="p">},</span>
    <span class="s1">&#39;Ex&#39;</span><span class="p">:{</span><span class="s1">&#39;trigger&#39;</span><span class="p">:</span> <span class="s1">&#39;dg&#39;</span><span class="p">,</span>     <span class="c1"># &#39;dg&#39; label indicates event triggered by damage caused by any peril (tutorial 3)</span>
          <span class="s1">&#39;S&#39;</span><span class="p">:</span> <span class="mf">1.</span><span class="p">,</span> <span class="s1">&#39;Sunit&#39;</span><span class="p">:</span> <span class="s1">&#39;Explosive yield (kton)&#39;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">eventSet</span> <span class="o">=</span> <span class="n">GenMR_perils</span><span class="o">.</span><span class="n">EventSetGenerator</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">sizeDistr</span><span class="p">,</span> <span class="n">GenMR_utils</span><span class="p">)</span>
<span class="n">evtable</span><span class="p">,</span> <span class="n">evchar</span> <span class="o">=</span> <span class="n">eventSet</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>

<span class="c1">#evtable</span>
<span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">option_context</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span>
                       <span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
    <span class="n">display</span><span class="p">(</span><span class="n">evtable</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>srcID</th>
      <th>evID</th>
      <th>S</th>
      <th>lbd</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AI</td>
      <td>impact1</td>
      <td>AI1</td>
      <td>10.000000</td>
      <td>2.657777e-06</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AI</td>
      <td>impact2</td>
      <td>AI2</td>
      <td>10.000000</td>
      <td>2.657777e-06</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AI</td>
      <td>impact3</td>
      <td>AI3</td>
      <td>10.000000</td>
      <td>2.657777e-06</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AI</td>
      <td>impact4</td>
      <td>AI4</td>
      <td>100.000000</td>
      <td>2.509457e-07</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AI</td>
      <td>impact5</td>
      <td>AI5</td>
      <td>100.000000</td>
      <td>2.509457e-07</td>
    </tr>
    <tr>
      <th>5</th>
      <td>AI</td>
      <td>impact6</td>
      <td>AI6</td>
      <td>100.000000</td>
      <td>2.509457e-07</td>
    </tr>
    <tr>
      <th>6</th>
      <td>AI</td>
      <td>impact7</td>
      <td>AI7</td>
      <td>100.000000</td>
      <td>2.509457e-07</td>
    </tr>
    <tr>
      <th>7</th>
      <td>AI</td>
      <td>impact8</td>
      <td>AI8</td>
      <td>1000.000000</td>
      <td>4.212292e-08</td>
    </tr>
    <tr>
      <th>8</th>
      <td>AI</td>
      <td>impact9</td>
      <td>AI9</td>
      <td>1000.000000</td>
      <td>4.212292e-08</td>
    </tr>
    <tr>
      <th>9</th>
      <td>AI</td>
      <td>impact10</td>
      <td>AI10</td>
      <td>1000.000000</td>
      <td>4.212292e-08</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Dr</td>
      <td>soil</td>
      <td>Dr1</td>
      <td>3.000000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Dr</td>
      <td>soil</td>
      <td>Dr2</td>
      <td>6.000000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Dr</td>
      <td>soil</td>
      <td>Dr3</td>
      <td>9.000000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>13</th>
      <td>EQ</td>
      <td>fault1</td>
      <td>EQ1</td>
      <td>6.000000</td>
      <td>6.855726e-03</td>
    </tr>
    <tr>
      <th>14</th>
      <td>EQ</td>
      <td>fault2</td>
      <td>EQ2</td>
      <td>6.000000</td>
      <td>6.855726e-03</td>
    </tr>
    <tr>
      <th>15</th>
      <td>EQ</td>
      <td>fault1</td>
      <td>EQ3</td>
      <td>6.000000</td>
      <td>6.855726e-03</td>
    </tr>
    <tr>
      <th>16</th>
      <td>EQ</td>
      <td>fault1</td>
      <td>EQ4</td>
      <td>6.100000</td>
      <td>5.445696e-03</td>
    </tr>
    <tr>
      <th>17</th>
      <td>EQ</td>
      <td>fault1</td>
      <td>EQ5</td>
      <td>6.100000</td>
      <td>5.445696e-03</td>
    </tr>
    <tr>
      <th>18</th>
      <td>EQ</td>
      <td>fault1</td>
      <td>EQ6</td>
      <td>6.100000</td>
      <td>5.445696e-03</td>
    </tr>
    <tr>
      <th>19</th>
      <td>EQ</td>
      <td>fault1</td>
      <td>EQ7</td>
      <td>6.200000</td>
      <td>6.488506e-03</td>
    </tr>
    <tr>
      <th>20</th>
      <td>EQ</td>
      <td>fault1</td>
      <td>EQ8</td>
      <td>6.200000</td>
      <td>6.488506e-03</td>
    </tr>
    <tr>
      <th>21</th>
      <td>EQ</td>
      <td>fault1</td>
      <td>EQ9</td>
      <td>6.300000</td>
      <td>3.436002e-03</td>
    </tr>
    <tr>
      <th>22</th>
      <td>EQ</td>
      <td>fault1</td>
      <td>EQ10</td>
      <td>6.300000</td>
      <td>3.436002e-03</td>
    </tr>
    <tr>
      <th>23</th>
      <td>EQ</td>
      <td>fault1</td>
      <td>EQ11</td>
      <td>6.300000</td>
      <td>3.436002e-03</td>
    </tr>
    <tr>
      <th>24</th>
      <td>EQ</td>
      <td>fault1</td>
      <td>EQ12</td>
      <td>6.400000</td>
      <td>4.093970e-03</td>
    </tr>
    <tr>
      <th>25</th>
      <td>EQ</td>
      <td>fault1</td>
      <td>EQ13</td>
      <td>6.400000</td>
      <td>4.093970e-03</td>
    </tr>
    <tr>
      <th>26</th>
      <td>EQ</td>
      <td>fault2</td>
      <td>EQ14</td>
      <td>6.500000</td>
      <td>3.251956e-03</td>
    </tr>
    <tr>
      <th>27</th>
      <td>EQ</td>
      <td>fault1</td>
      <td>EQ15</td>
      <td>6.500000</td>
      <td>3.251956e-03</td>
    </tr>
    <tr>
      <th>28</th>
      <td>EQ</td>
      <td>fault1</td>
      <td>EQ16</td>
      <td>6.600000</td>
      <td>5.166241e-03</td>
    </tr>
    <tr>
      <th>29</th>
      <td>EQ</td>
      <td>fault1</td>
      <td>EQ17</td>
      <td>6.700000</td>
      <td>4.103691e-03</td>
    </tr>
    <tr>
      <th>30</th>
      <td>EQ</td>
      <td>fault1</td>
      <td>EQ18</td>
      <td>6.800000</td>
      <td>3.259678e-03</td>
    </tr>
    <tr>
      <th>31</th>
      <td>EQ</td>
      <td>fault1</td>
      <td>EQ19</td>
      <td>6.900000</td>
      <td>2.589254e-03</td>
    </tr>
    <tr>
      <th>32</th>
      <td>EQ</td>
      <td>fault1</td>
      <td>EQ20</td>
      <td>7.000000</td>
      <td>2.056718e-03</td>
    </tr>
    <tr>
      <th>33</th>
      <td>HW</td>
      <td>atmosphere</td>
      <td>HW1</td>
      <td>7.000000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>34</th>
      <td>HW</td>
      <td>atmosphere</td>
      <td>HW2</td>
      <td>14.000000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>35</th>
      <td>HW</td>
      <td>atmosphere</td>
      <td>HW3</td>
      <td>30.000000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>36</th>
      <td>RS</td>
      <td>atmosphere</td>
      <td>RS1</td>
      <td>75.000000</td>
      <td>1.000793e-03</td>
    </tr>
    <tr>
      <th>37</th>
      <td>RS</td>
      <td>atmosphere</td>
      <td>RS2</td>
      <td>100.000000</td>
      <td>8.172054e-05</td>
    </tr>
    <tr>
      <th>38</th>
      <td>RS</td>
      <td>atmosphere</td>
      <td>RS3</td>
      <td>125.000000</td>
      <td>4.562873e-06</td>
    </tr>
    <tr>
      <th>39</th>
      <td>TC</td>
      <td>stormtrack1</td>
      <td>TC1</td>
      <td>40.000000</td>
      <td>2.841439e-04</td>
    </tr>
    <tr>
      <th>40</th>
      <td>TC</td>
      <td>stormtrack2</td>
      <td>TC2</td>
      <td>50.000000</td>
      <td>1.637893e-04</td>
    </tr>
    <tr>
      <th>41</th>
      <td>TC</td>
      <td>stormtrack3</td>
      <td>TC3</td>
      <td>60.000000</td>
      <td>4.064719e-05</td>
    </tr>
    <tr>
      <th>42</th>
      <td>TC</td>
      <td>stormtrack4</td>
      <td>TC4</td>
      <td>60.000000</td>
      <td>4.064719e-05</td>
    </tr>
    <tr>
      <th>43</th>
      <td>TC</td>
      <td>stormtrack5</td>
      <td>TC5</td>
      <td>70.000000</td>
      <td>3.110718e-05</td>
    </tr>
    <tr>
      <th>44</th>
      <td>To</td>
      <td>vortexline1</td>
      <td>To1</td>
      <td>3.000000</td>
      <td>4.537519e-05</td>
    </tr>
    <tr>
      <th>45</th>
      <td>To</td>
      <td>vortexline2</td>
      <td>To2</td>
      <td>3.000000</td>
      <td>4.537519e-05</td>
    </tr>
    <tr>
      <th>46</th>
      <td>To</td>
      <td>vortexline3</td>
      <td>To3</td>
      <td>3.000000</td>
      <td>4.537519e-05</td>
    </tr>
    <tr>
      <th>47</th>
      <td>To</td>
      <td>vortexline4</td>
      <td>To4</td>
      <td>4.000000</td>
      <td>5.712399e-06</td>
    </tr>
    <tr>
      <th>48</th>
      <td>To</td>
      <td>vortexline5</td>
      <td>To5</td>
      <td>4.000000</td>
      <td>5.712399e-06</td>
    </tr>
    <tr>
      <th>49</th>
      <td>To</td>
      <td>vortexline6</td>
      <td>To6</td>
      <td>4.000000</td>
      <td>5.712399e-06</td>
    </tr>
    <tr>
      <th>50</th>
      <td>To</td>
      <td>vortexline7</td>
      <td>To7</td>
      <td>5.000000</td>
      <td>7.191484e-07</td>
    </tr>
    <tr>
      <th>51</th>
      <td>To</td>
      <td>vortexline8</td>
      <td>To8</td>
      <td>5.000000</td>
      <td>7.191484e-07</td>
    </tr>
    <tr>
      <th>52</th>
      <td>To</td>
      <td>vortexline9</td>
      <td>To9</td>
      <td>5.000000</td>
      <td>7.191484e-07</td>
    </tr>
    <tr>
      <th>53</th>
      <td>VE</td>
      <td>volcano1</td>
      <td>VE1</td>
      <td>1.000000</td>
      <td>7.303024e-07</td>
    </tr>
    <tr>
      <th>54</th>
      <td>VE</td>
      <td>volcano1</td>
      <td>VE2</td>
      <td>3.162278</td>
      <td>3.415881e-07</td>
    </tr>
    <tr>
      <th>55</th>
      <td>VE</td>
      <td>volcano1</td>
      <td>VE3</td>
      <td>10.000000</td>
      <td>1.597728e-07</td>
    </tr>
    <tr>
      <th>56</th>
      <td>WF</td>
      <td>forest</td>
      <td>WF1</td>
      <td>10000.000000</td>
      <td>1.062953e-02</td>
    </tr>
    <tr>
      <th>57</th>
      <td>WF</td>
      <td>forest</td>
      <td>WF2</td>
      <td>10000.000000</td>
      <td>1.062953e-02</td>
    </tr>
    <tr>
      <th>58</th>
      <td>WF</td>
      <td>forest</td>
      <td>WF3</td>
      <td>10000.000000</td>
      <td>1.062953e-02</td>
    </tr>
    <tr>
      <th>59</th>
      <td>WF</td>
      <td>forest</td>
      <td>WF4</td>
      <td>10000.000000</td>
      <td>1.062953e-02</td>
    </tr>
    <tr>
      <th>60</th>
      <td>WF</td>
      <td>forest</td>
      <td>WF5</td>
      <td>10000.000000</td>
      <td>1.062953e-02</td>
    </tr>
    <tr>
      <th>61</th>
      <td>WF</td>
      <td>forest</td>
      <td>WF6</td>
      <td>10000.000000</td>
      <td>1.062953e-02</td>
    </tr>
    <tr>
      <th>62</th>
      <td>WF</td>
      <td>forest</td>
      <td>WF7</td>
      <td>31622.776602</td>
      <td>5.158744e-03</td>
    </tr>
    <tr>
      <th>63</th>
      <td>WF</td>
      <td>forest</td>
      <td>WF8</td>
      <td>31622.776602</td>
      <td>5.158744e-03</td>
    </tr>
    <tr>
      <th>64</th>
      <td>WF</td>
      <td>forest</td>
      <td>WF9</td>
      <td>31622.776602</td>
      <td>5.158744e-03</td>
    </tr>
    <tr>
      <th>65</th>
      <td>WF</td>
      <td>forest</td>
      <td>WF10</td>
      <td>100000.000000</td>
      <td>3.755478e-03</td>
    </tr>
    <tr>
      <th>66</th>
      <td>WS</td>
      <td>atmosphere</td>
      <td>WS1</td>
      <td>45.000000</td>
      <td>2.741867e-03</td>
    </tr>
    <tr>
      <th>67</th>
      <td>WS</td>
      <td>atmosphere</td>
      <td>WS2</td>
      <td>50.000000</td>
      <td>1.746819e-05</td>
    </tr>
    <tr>
      <th>68</th>
      <td>CS</td>
      <td>supercell</td>
      <td>CS_toTo1</td>
      <td>13.811900</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>69</th>
      <td>CS</td>
      <td>supercell</td>
      <td>CS_toTo2</td>
      <td>13.811900</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>70</th>
      <td>CS</td>
      <td>supercell</td>
      <td>CS_toTo3</td>
      <td>13.811900</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>71</th>
      <td>CS</td>
      <td>supercell</td>
      <td>CS_toTo4</td>
      <td>13.811900</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>72</th>
      <td>CS</td>
      <td>supercell</td>
      <td>CS_toTo5</td>
      <td>13.811900</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>73</th>
      <td>CS</td>
      <td>supercell</td>
      <td>CS_toTo6</td>
      <td>13.811900</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>74</th>
      <td>CS</td>
      <td>supercell</td>
      <td>CS_toTo7</td>
      <td>13.811900</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>75</th>
      <td>CS</td>
      <td>supercell</td>
      <td>CS_toTo8</td>
      <td>13.811900</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>76</th>
      <td>CS</td>
      <td>supercell</td>
      <td>CS_toTo9</td>
      <td>13.811900</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>77</th>
      <td>FF</td>
      <td>river1</td>
      <td>FF_fromRS1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>78</th>
      <td>FF</td>
      <td>river1</td>
      <td>FF_fromRS2</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>79</th>
      <td>FF</td>
      <td>river1</td>
      <td>FF_fromRS3</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>80</th>
      <td>Li</td>
      <td>supercell</td>
      <td>Li_fromCS1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>81</th>
      <td>Li</td>
      <td>supercell</td>
      <td>Li_fromCS2</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>82</th>
      <td>Li</td>
      <td>supercell</td>
      <td>Li_fromCS3</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>83</th>
      <td>Li</td>
      <td>supercell</td>
      <td>Li_fromCS4</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>84</th>
      <td>Li</td>
      <td>supercell</td>
      <td>Li_fromCS5</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>85</th>
      <td>Li</td>
      <td>supercell</td>
      <td>Li_fromCS6</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>86</th>
      <td>Li</td>
      <td>supercell</td>
      <td>Li_fromCS7</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>87</th>
      <td>Li</td>
      <td>supercell</td>
      <td>Li_fromCS8</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>88</th>
      <td>Li</td>
      <td>supercell</td>
      <td>Li_fromCS9</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>89</th>
      <td>LS</td>
      <td>terrain</td>
      <td>LS_fromRS1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>90</th>
      <td>LS</td>
      <td>terrain</td>
      <td>LS_fromRS2</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>91</th>
      <td>LS</td>
      <td>terrain</td>
      <td>LS_fromRS3</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>92</th>
      <td>SS</td>
      <td>coastline</td>
      <td>SS_fromTC1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>93</th>
      <td>SS</td>
      <td>coastline</td>
      <td>SS_fromTC2</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>94</th>
      <td>SS</td>
      <td>coastline</td>
      <td>SS_fromTC3</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>95</th>
      <td>SS</td>
      <td>coastline</td>
      <td>SS_fromTC4</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>96</th>
      <td>SS</td>
      <td>coastline</td>
      <td>SS_fromTC5</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Running the <code class="docutils literal notranslate"><span class="pre">EventSetGenerator</span></code> is effectively instantaneous. In contrast, computing drought (<code class="docutils literal notranslate"><span class="pre">Dr</span></code>) rates requires several minutes and is therefore executed as a separate step (see below). The calculation is based on a water-balance model in which soil water content evolves from an initial state (defined by the soil layers <code class="docutils literal notranslate"><span class="pre">'moisture_regime'</span></code>) and is subsequently modulated by evapotranspiration (see <code class="docutils literal notranslate"><span class="pre">calc_PET()</span></code>) and precipitation (see <code class="docutils literal notranslate"><span class="pre">gen_precipitation()</span></code>) over the twelve months of a calendar year. Conditions conducive to drought development arise during anticyclonic years, when accompanied by anomalously high summer temperatures.</p>
<p><strong>Note:</strong> The correlation between <code class="docutils literal notranslate"><span class="pre">Dr</span></code> and <code class="docutils literal notranslate"><span class="pre">HW</span></code>, and the anticorrelation with <code class="docutils literal notranslate"><span class="pre">RS</span></code>, will be examined in Tutorial 3.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rates_Dr</span> <span class="o">=</span> <span class="n">GenMR_perils</span><span class="o">.</span><span class="n">calc_lbd_Dr</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;Dr&#39;</span><span class="p">],</span> <span class="n">atmoLayer</span><span class="o">.</span><span class="n">par</span><span class="p">,</span> <span class="n">soilLayer</span><span class="o">.</span><span class="n">par</span><span class="p">)</span>

<span class="c1"># update event table</span>
<span class="n">evtable</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">evtable</span><span class="p">[</span><span class="s1">&#39;evID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Dr&#39;</span><span class="p">,</span> <span class="s1">&#39;lbd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rates_Dr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Simulating droughts: 100%|| 1000000/1000000 [07:50&lt;00:00, 2126.89it/s]
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">evchar</span></code> dataframe contains the coordinates of the events defined in <code class="docutils literal notranslate"><span class="pre">evtable</span></code>. The following code cell allows the user to plot stochastic events via their <code class="docutils literal notranslate"><span class="pre">evID</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#print(&#39;total list of modelled events, by evID:&#39;, evtable[&#39;evID&#39;].unique())</span>

<span class="c1">## SELECT EVENTS ##</span>
<span class="n">evID_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;EQ1&#39;</span><span class="p">,</span><span class="s1">&#39;TC1&#39;</span><span class="p">,</span><span class="s1">&#39;CS_toTo1&#39;</span><span class="p">,</span> <span class="s1">&#39;To1&#39;</span><span class="p">,</span><span class="s1">&#39;Li_fromCS1&#39;</span><span class="p">]</span>
<span class="c1">#evID_list = evtable[&#39;evID&#39;].values</span>
<span class="c1">###################</span>

<span class="n">n_evID</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">evID_list</span><span class="p">)</span>

<span class="n">max_cols</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">n_evID</span><span class="p">,</span> <span class="n">max_cols</span><span class="p">)</span>
<span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">n_evID</span> <span class="o">/</span> <span class="n">ncols</span><span class="p">))</span>

<span class="n">evID_coords</span> <span class="o">=</span> <span class="n">evchar</span><span class="p">[</span><span class="n">evchar</span><span class="p">[</span><span class="s1">&#39;evID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">evID_list</span><span class="p">)]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;16&#39;</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">ncols</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">nrows</span><span class="p">),</span> <span class="n">squeeze</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_evID</span><span class="p">):</span>
    <span class="n">peril_evID</span> <span class="o">=</span> <span class="n">evID_list</span><span class="p">[</span><span class="n">i</span><span class="p">][:</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">peril_evID</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;AI&#39;</span><span class="p">,</span> <span class="s1">&#39;VE&#39;</span><span class="p">,</span> <span class="s1">&#39;Li&#39;</span><span class="p">]:</span>
        <span class="n">plot_type</span> <span class="o">=</span> <span class="s1">&#39;scatter&#39;</span>
    <span class="k">elif</span>  <span class="n">peril_evID</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;EQ&#39;</span><span class="p">,</span> <span class="s1">&#39;TC&#39;</span><span class="p">,</span> <span class="s1">&#39;To&#39;</span><span class="p">,</span> <span class="s1">&#39;CS&#39;</span><span class="p">,</span> <span class="s1">&#39;SS&#39;</span><span class="p">]:</span>
        <span class="n">plot_type</span> <span class="o">=</span> <span class="s1">&#39;plot&#39;</span>
    <span class="n">coords2plt</span> <span class="o">=</span> <span class="n">evID_coords</span><span class="p">[</span><span class="n">evID_coords</span><span class="p">[</span><span class="s1">&#39;evID&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">evID_list</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xx</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">yy</span><span class="p">,</span> <span class="n">GenMR_env</span><span class="o">.</span><span class="n">ls</span><span class="o">.</span><span class="n">hillshade</span><span class="p">(</span><span class="n">topoLayer</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">vert_exag</span><span class="o">=</span><span class="mf">.1</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">.1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s1">&#39;plot&#39;</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coords2plt</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">coords2plt</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;darkred&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s1">&#39;scatter&#39;</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">coords2plt</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">coords2plt</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;darkred&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">xmax</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">ymin</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">ymax</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x$ (km)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y$ (km)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">evID_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">pad</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_evID</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ax</span><span class="p">)):</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/344381000095ad3b0f7c4eec2b7b59c61836601e803f9f77df559ac601e0847c.png" src="../_images/344381000095ad3b0f7c4eec2b7b59c61836601e803f9f77df559ac601e0847c.png" />
</div>
</div>
</section>
<section id="intensity-footprint-catalogue-generation">
<h3>1.3. Intensity footprint catalogue generation<a class="headerlink" href="#intensity-footprint-catalogue-generation" title="Link to this heading"></a></h3>
<p>Once the event table has been generated, the next step is to produce one mean hazard-intensity footprint per event. Aleatory uncertainty is not implemented for simplicity, and because it does not affect the objectives of this project, namely, modelling compound events in a virtual environment (see the third and final tutorial).</p>
<section id="from-analytical-expressions-threshold-models">
<h4>1.3.1. From analytical expressions &amp; threshold models<a class="headerlink" href="#from-analytical-expressions-threshold-models" title="Link to this heading"></a></h4>
<section id="analytical-expressions">
<h5>1.3.1.1. Analytical expressions<a class="headerlink" href="#analytical-expressions" title="Link to this heading"></a></h5>
<p>Analytical expressions are available to calculate intensity <span class="math notranslate nohighlight">\(I(x,y) = f_I(S,r)\)</span> for the <code class="docutils literal notranslate"><span class="pre">AI</span></code>/<code class="docutils literal notranslate"><span class="pre">Ex</span></code>, <code class="docutils literal notranslate"><span class="pre">EQ</span></code>, <code class="docutils literal notranslate"><span class="pre">VE</span></code> and <code class="docutils literal notranslate"><span class="pre">TC</span></code> perils (Mignan, 2024:sec. 2.4.1). The size <span class="math notranslate nohighlight">\(S\)</span> is provided in <code class="docutils literal notranslate"><span class="pre">evtable</span></code>, while the distance-to-source <span class="math notranslate nohighlight">\(r\)</span> is obtained by matching each event to its corresponding source coordinates via <code class="docutils literal notranslate"><span class="pre">evchar</span></code>. Because generating <code class="docutils literal notranslate"><span class="pre">TC</span></code> footprints requires a multi-step procedure, additional details are provided in Appendix C.</p>
<p>The models are implemented as <code class="docutils literal notranslate"><span class="pre">calc_I_*(S,r)</span></code> functions in the Python file, using the equations from Mignan (2024:sec. 2.4.1):</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-left"><p>ID</p></th>
<th class="head text-left"><p>Event size <span class="math notranslate nohighlight">\(S\)</span></p></th>
<th class="head text-left"><p>Intensity <span class="math notranslate nohighlight">\(I\)</span></p></th>
<th class="head text-left"><p>Equation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">AI</span></code>, <code class="docutils literal notranslate"><span class="pre">Ex</span></code></p></td>
<td class="text-left"><p>Explosive mass <span class="math notranslate nohighlight">\(m_{TNT}\)</span> (kt)</p></td>
<td class="text-left"><p>Blast overpressure <span class="math notranslate nohighlight">\(P\)</span> (kPa)</p></td>
<td class="text-left"><p>Eq. 2.56</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">EQ</span></code></p></td>
<td class="text-left"><p>Magnitude <span class="math notranslate nohighlight">\(M\)</span></p></td>
<td class="text-left"><p>Peak ground acceleration PGA (m/s<span class="math notranslate nohighlight">\(^2\)</span>)</p></td>
<td class="text-left"><p>Eq. 2.54</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">Li</span></code></p></td>
<td class="text-left"><p>-</p></td>
<td class="text-left"><p>Lightning strike count (/convective storm)</p></td>
<td class="text-left"><p>to add</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">TC</span></code></p></td>
<td class="text-left"><p>Maximum wind speed <span class="math notranslate nohighlight">\(v_{max}\)</span> (m/s)</p></td>
<td class="text-left"><p>Wind speed <span class="math notranslate nohighlight">\(v\)</span> (m/s)</p></td>
<td class="text-left"><p>Eq. 2.24</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">To</span></code></p></td>
<td class="text-left"><p>Enhanced Fujita (EF) scale to max. wind speed (m/s)</p></td>
<td class="text-left"><p>Max. wind speed <span class="math notranslate nohighlight">\(v_{max}\)</span> (m/s)</p></td>
<td class="text-left"><p>Eq. 2.59</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">VE</span></code></p></td>
<td class="text-left"><p>Erupted volume <span class="math notranslate nohighlight">\(V\)</span> (km<span class="math notranslate nohighlight">\(^3\)</span>)</p></td>
<td class="text-left"><p>Ash load <span class="math notranslate nohighlight">\(P\)</span> (kPa), converted from thickness (m)</p></td>
<td class="text-left"><p>Eq. 2.61</p></td>
</tr>
</tbody>
</table>
<p>Note that rainstorm (<code class="docutils literal notranslate"><span class="pre">RS</span></code>) and windstorm (<code class="docutils literal notranslate"><span class="pre">WS</span></code>) footprints are considered spatially homogeneous (prior to the application of any site-specific conditions, which will be addressed subsequently) due to the relatively small size of the active domain of the digital template. Accordingly, their source classes are defined as area sources, and their intensity classes are defined using thresholds, with the threshold value corresponding to the event size <code class="docutils literal notranslate"><span class="pre">S</span></code> by construction.</p>
</section>
<section id="threshold-models">
<h5>1.3.1.2. Threshold models<a class="headerlink" href="#threshold-models" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p>Heatwave (<code class="docutils literal notranslate"><span class="pre">HW</span></code>): Based on an event being declared when the near-surface air temperature equals or exceeds <code class="docutils literal notranslate"><span class="pre">T_th</span></code> for at least <code class="docutils literal notranslate"><span class="pre">Dt_da</span></code> consecutive days. Temperature extremes in the digital template arise from the combination of large-scale advective temperature anomalies and temporally correlated daily temperature variability (see the <code class="docutils literal notranslate"><span class="pre">model_HW_threshold()</span></code> function). It should be noted that, for a given event size <code class="docutils literal notranslate"><span class="pre">S</span></code>, the largest spatial footprint (i.e., the most extreme realization) is selected from a larger stochastic event set (see all candidate footprints in <code class="docutils literal notranslate"><span class="pre">figs/HW_stochset_tmp/</span></code>).</p></li>
<li><p>Storm surge (<code class="docutils literal notranslate"><span class="pre">SS</span></code>): Based on the Bathtub model (Mignan, 2024:sec. 2.4.2). The algorithm is intentionally simple and tailored to the virtual environment used here, where the background topography exhibits a predominantly west-east gradient (see the <code class="docutils literal notranslate"><span class="pre">model_SS_Bathtub()</span></code> function). As a secondary peril triggered by <code class="docutils literal notranslate"><span class="pre">TC</span></code> events, the <code class="docutils literal notranslate"><span class="pre">SS</span></code> size along the coastline is derived from a relationship of the form <span class="math notranslate nohighlight">\(h_{max} \propto v_{max}^2\)</span> (Mignan, 2024:fig. 2.7), where <span class="math notranslate nohighlight">\(v_{max}\)</span> is the wind speed along the coastline obtained from the <code class="docutils literal notranslate"><span class="pre">TC</span></code> footprint.</p></li>
</ul>
<p>The catalogue of hazard footprints is generated via the <code class="docutils literal notranslate"><span class="pre">HazardFootprintGenerator(()</span></code> class and is visualised with <code class="docutils literal notranslate"><span class="pre">plot_hazFootprints()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;TC&#39;</span><span class="p">][</span><span class="s1">&#39;vforward_m/s&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10.</span>         <span class="c1"># forward storm speed (m/s)</span>
<span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;TC&#39;</span><span class="p">][</span><span class="s1">&#39;pn_mbar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1005.</span>            <span class="c1"># ambient pressure (mbar) - NB: consider using atm. layer p0</span>
<span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;TC&#39;</span><span class="p">][</span><span class="s1">&#39;B_Holland&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>              <span class="c1"># Holland&#39;s parameter (see Fig. 2.10 of textbook)</span>
<span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;TC&#39;</span><span class="p">][</span><span class="s1">&#39;lat_deg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">lat_deg</span>     <span class="c1"># average latitude of digital template (see Tutorial 1)</span>

<span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;To&#39;</span><span class="p">][</span><span class="s1">&#39;Rmax_m&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">300.</span>              <span class="c1"># user-defined, independent of EF scale since no model available</span>
                                            <span class="c1"># high value used for illustration</span>

<span class="c1"># virtual region bathymetry characteristics for SS height given storm wind speed</span>
<span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;SS&#39;</span><span class="p">][</span><span class="s1">&#39;bathy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;New York harbor&#39;</span>  <span class="c1"># &#39;generic&#39; (Saffir-Simpson, Mignan, 2024:eq. 2.16) </span>
                                            <span class="c1"># &#39;New York harbor&#39; (eq. in Mignan, 2024:fig. 2.7)</span>

<span class="c1">## TO ADD: site-specific conditions ##</span>
<span class="c1"># surface friction -&gt; reduce windspeed (TC, WS)</span>
<span class="c1"># soil amplification -&gt; increase ground shaking (EQ)</span>
<span class="c1"># urban heat island -&gt; increase temperature (HW)</span>
<span class="c1"># other?</span>

<span class="n">hazFootprints</span> <span class="o">=</span> <span class="n">GenMR_perils</span><span class="o">.</span><span class="n">HazardFootprintGenerator</span><span class="p">(</span><span class="n">evtable</span><span class="p">,</span> <span class="n">evchar</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">topoLayer</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">atmoLayer</span><span class="p">)</span>
<span class="n">catalog_hazFootprints</span> <span class="o">=</span> <span class="n">hazFootprints</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>generating footprints for: AI... Dr... EQ... HW... (loading from cache)
RS... TC... To... VE... WF... WS... CS... FF... Li... LS... SS... catalogue completed
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># max intensity Imax in color range (see units in previous table)</span>
<span class="c1"># to compare similar levels of expected damage, choose a value per peril for a constant MDR in the vulnerability</span>
<span class="c1"># curves (see curves generated by plot_vulnFunctions())</span>
<span class="n">Imax_Ex_totaldestruction</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="mf">6.89476</span>  <span class="c1"># kPa (here 4 psi as threshold of total destruction)</span>

<span class="n">plot_Imax</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;AI&#39;</span><span class="p">:</span> <span class="n">Imax_Ex_totaldestruction</span><span class="p">,</span> <span class="s1">&#39;EQ&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;Ex&#39;</span><span class="p">:</span> <span class="n">Imax_Ex_totaldestruction</span><span class="p">,</span> \
             <span class="s1">&#39;HW&#39;</span><span class="p">:</span> <span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;HW&#39;</span><span class="p">][</span><span class="s1">&#39;T_th&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;LS&#39;</span><span class="p">:</span> <span class="mf">2.</span><span class="p">,</span> \
             <span class="s1">&#39;SS&#39;</span><span class="p">:</span> <span class="mf">2.</span><span class="p">,</span> <span class="s1">&#39;TC&#39;</span><span class="p">:</span> <span class="mf">70.</span><span class="p">,</span> <span class="s1">&#39;To&#39;</span><span class="p">:</span> <span class="mf">70.</span><span class="p">,</span> <span class="s1">&#39;VE&#39;</span><span class="p">:</span> <span class="mf">.5</span><span class="p">,</span> <span class="s1">&#39;WS&#39;</span><span class="p">:</span> <span class="mf">70.</span><span class="p">}</span>
<span class="n">f</span> <span class="o">=</span> <span class="mf">.1</span>
<span class="n">plot_Imin</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;AI&#39;</span><span class="p">:</span> <span class="n">f</span><span class="o">*</span><span class="n">plot_Imax</span><span class="p">[</span><span class="s1">&#39;AI&#39;</span><span class="p">],</span> <span class="s1">&#39;EQ&#39;</span><span class="p">:</span> <span class="n">f</span><span class="o">*</span><span class="n">plot_Imax</span><span class="p">[</span><span class="s1">&#39;EQ&#39;</span><span class="p">],</span> <span class="s1">&#39;Ex&#39;</span><span class="p">:</span> <span class="n">f</span><span class="o">*</span><span class="n">plot_Imax</span><span class="p">[</span><span class="s1">&#39;Ex&#39;</span><span class="p">],</span> \
             <span class="s1">&#39;HW&#39;</span><span class="p">:</span> <span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;HW&#39;</span><span class="p">][</span><span class="s1">&#39;T_th&#39;</span><span class="p">],</span> <span class="s1">&#39;LS&#39;</span><span class="p">:</span> <span class="n">f</span><span class="o">*</span><span class="n">plot_Imax</span><span class="p">[</span><span class="s1">&#39;LS&#39;</span><span class="p">],</span> <span class="s1">&#39;SS&#39;</span><span class="p">:</span> <span class="n">f</span><span class="o">*</span><span class="n">plot_Imax</span><span class="p">[</span><span class="s1">&#39;SS&#39;</span><span class="p">],</span> \
             <span class="s1">&#39;TC&#39;</span><span class="p">:</span> <span class="mf">30.</span><span class="p">,</span> <span class="s1">&#39;To&#39;</span><span class="p">:</span> <span class="mf">30.</span><span class="p">,</span> <span class="s1">&#39;VE&#39;</span><span class="p">:</span> <span class="n">f</span><span class="o">*</span><span class="n">plot_Imax</span><span class="p">[</span><span class="s1">&#39;VE&#39;</span><span class="p">],</span> <span class="s1">&#39;WS&#39;</span><span class="p">:</span> <span class="mf">30.</span><span class="p">}</span>

<span class="c1"># nstoch (default = 5) defines the number of events per peril to be displayed by row</span>
<span class="c1"># if the number of events &gt; nstoch, footprints are randomly sampled from all possibilities</span>
<span class="n">GenMR_perils</span><span class="o">.</span><span class="n">plot_hazFootprints</span><span class="p">(</span><span class="n">catalog_hazFootprints</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">topoLayer</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">plot_Imin</span><span class="p">,</span> <span class="n">plot_Imax</span><span class="p">)</span>  <span class="c1">#, nstoch = 5)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/08e514226419239e0fd6c83efc0e7dac27587ced5d69507cd0d907f4616df5f2.png" src="../_images/08e514226419239e0fd6c83efc0e7dac27587ced5d69507cd0d907f4616df5f2.png" />
</div>
</div>
<p><strong>Note:</strong> Observe the <code class="docutils literal notranslate"><span class="pre">TC</span></code> footprint boundary effect (cyclonic eye), which is due to the track artificially starting at <code class="docutils literal notranslate"><span class="pre">grid.xmin</span></code>.</p>
<p>It was previously indicated that the <code class="docutils literal notranslate"><span class="pre">HW</span></code> event rates are computed jointly with the generation of their intensity footprints. It is possible to retrieve these rates from:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rates_HW</span> <span class="o">=</span> <span class="n">hazFootprints</span><span class="o">.</span><span class="n">rate_HW</span>

<span class="c1"># update event table</span>
<span class="n">evtable</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">evtable</span><span class="p">[</span><span class="s1">&#39;evID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;HW&#39;</span><span class="p">,</span> <span class="s1">&#39;lbd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rates_HW</span>

<span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">option_context</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
    <span class="n">display</span><span class="p">(</span><span class="n">evtable</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>srcID</th>
      <th>evID</th>
      <th>S</th>
      <th>lbd</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AI</td>
      <td>impact1</td>
      <td>AI1</td>
      <td>10.000000</td>
      <td>2.657777e-06</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AI</td>
      <td>impact2</td>
      <td>AI2</td>
      <td>10.000000</td>
      <td>2.657777e-06</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AI</td>
      <td>impact3</td>
      <td>AI3</td>
      <td>10.000000</td>
      <td>2.657777e-06</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AI</td>
      <td>impact4</td>
      <td>AI4</td>
      <td>100.000000</td>
      <td>2.509457e-07</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AI</td>
      <td>impact5</td>
      <td>AI5</td>
      <td>100.000000</td>
      <td>2.509457e-07</td>
    </tr>
    <tr>
      <th>5</th>
      <td>AI</td>
      <td>impact6</td>
      <td>AI6</td>
      <td>100.000000</td>
      <td>2.509457e-07</td>
    </tr>
    <tr>
      <th>6</th>
      <td>AI</td>
      <td>impact7</td>
      <td>AI7</td>
      <td>100.000000</td>
      <td>2.509457e-07</td>
    </tr>
    <tr>
      <th>7</th>
      <td>AI</td>
      <td>impact8</td>
      <td>AI8</td>
      <td>1000.000000</td>
      <td>4.212292e-08</td>
    </tr>
    <tr>
      <th>8</th>
      <td>AI</td>
      <td>impact9</td>
      <td>AI9</td>
      <td>1000.000000</td>
      <td>4.212292e-08</td>
    </tr>
    <tr>
      <th>9</th>
      <td>AI</td>
      <td>impact10</td>
      <td>AI10</td>
      <td>1000.000000</td>
      <td>4.212292e-08</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Dr</td>
      <td>soil</td>
      <td>Dr1</td>
      <td>3.000000</td>
      <td>4.250000e-04</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Dr</td>
      <td>soil</td>
      <td>Dr2</td>
      <td>6.000000</td>
      <td>9.500000e-05</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Dr</td>
      <td>soil</td>
      <td>Dr3</td>
      <td>9.000000</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>13</th>
      <td>EQ</td>
      <td>fault1</td>
      <td>EQ1</td>
      <td>6.000000</td>
      <td>6.855726e-03</td>
    </tr>
    <tr>
      <th>14</th>
      <td>EQ</td>
      <td>fault2</td>
      <td>EQ2</td>
      <td>6.000000</td>
      <td>6.855726e-03</td>
    </tr>
    <tr>
      <th>15</th>
      <td>EQ</td>
      <td>fault1</td>
      <td>EQ3</td>
      <td>6.000000</td>
      <td>6.855726e-03</td>
    </tr>
    <tr>
      <th>16</th>
      <td>EQ</td>
      <td>fault1</td>
      <td>EQ4</td>
      <td>6.100000</td>
      <td>5.445696e-03</td>
    </tr>
    <tr>
      <th>17</th>
      <td>EQ</td>
      <td>fault1</td>
      <td>EQ5</td>
      <td>6.100000</td>
      <td>5.445696e-03</td>
    </tr>
    <tr>
      <th>18</th>
      <td>EQ</td>
      <td>fault1</td>
      <td>EQ6</td>
      <td>6.100000</td>
      <td>5.445696e-03</td>
    </tr>
    <tr>
      <th>19</th>
      <td>EQ</td>
      <td>fault1</td>
      <td>EQ7</td>
      <td>6.200000</td>
      <td>6.488506e-03</td>
    </tr>
    <tr>
      <th>20</th>
      <td>EQ</td>
      <td>fault1</td>
      <td>EQ8</td>
      <td>6.200000</td>
      <td>6.488506e-03</td>
    </tr>
    <tr>
      <th>21</th>
      <td>EQ</td>
      <td>fault1</td>
      <td>EQ9</td>
      <td>6.300000</td>
      <td>3.436002e-03</td>
    </tr>
    <tr>
      <th>22</th>
      <td>EQ</td>
      <td>fault1</td>
      <td>EQ10</td>
      <td>6.300000</td>
      <td>3.436002e-03</td>
    </tr>
    <tr>
      <th>23</th>
      <td>EQ</td>
      <td>fault1</td>
      <td>EQ11</td>
      <td>6.300000</td>
      <td>3.436002e-03</td>
    </tr>
    <tr>
      <th>24</th>
      <td>EQ</td>
      <td>fault1</td>
      <td>EQ12</td>
      <td>6.400000</td>
      <td>4.093970e-03</td>
    </tr>
    <tr>
      <th>25</th>
      <td>EQ</td>
      <td>fault1</td>
      <td>EQ13</td>
      <td>6.400000</td>
      <td>4.093970e-03</td>
    </tr>
    <tr>
      <th>26</th>
      <td>EQ</td>
      <td>fault2</td>
      <td>EQ14</td>
      <td>6.500000</td>
      <td>3.251956e-03</td>
    </tr>
    <tr>
      <th>27</th>
      <td>EQ</td>
      <td>fault1</td>
      <td>EQ15</td>
      <td>6.500000</td>
      <td>3.251956e-03</td>
    </tr>
    <tr>
      <th>28</th>
      <td>EQ</td>
      <td>fault1</td>
      <td>EQ16</td>
      <td>6.600000</td>
      <td>5.166241e-03</td>
    </tr>
    <tr>
      <th>29</th>
      <td>EQ</td>
      <td>fault1</td>
      <td>EQ17</td>
      <td>6.700000</td>
      <td>4.103691e-03</td>
    </tr>
    <tr>
      <th>30</th>
      <td>EQ</td>
      <td>fault1</td>
      <td>EQ18</td>
      <td>6.800000</td>
      <td>3.259678e-03</td>
    </tr>
    <tr>
      <th>31</th>
      <td>EQ</td>
      <td>fault1</td>
      <td>EQ19</td>
      <td>6.900000</td>
      <td>2.589254e-03</td>
    </tr>
    <tr>
      <th>32</th>
      <td>EQ</td>
      <td>fault1</td>
      <td>EQ20</td>
      <td>7.000000</td>
      <td>2.056718e-03</td>
    </tr>
    <tr>
      <th>33</th>
      <td>HW</td>
      <td>atmosphere</td>
      <td>HW1</td>
      <td>7.000000</td>
      <td>8.400000e-04</td>
    </tr>
    <tr>
      <th>34</th>
      <td>HW</td>
      <td>atmosphere</td>
      <td>HW2</td>
      <td>14.000000</td>
      <td>6.000000e-04</td>
    </tr>
    <tr>
      <th>35</th>
      <td>HW</td>
      <td>atmosphere</td>
      <td>HW3</td>
      <td>30.000000</td>
      <td>2.500000e-04</td>
    </tr>
    <tr>
      <th>36</th>
      <td>RS</td>
      <td>atmosphere</td>
      <td>RS1</td>
      <td>75.000000</td>
      <td>1.000793e-03</td>
    </tr>
    <tr>
      <th>37</th>
      <td>RS</td>
      <td>atmosphere</td>
      <td>RS2</td>
      <td>100.000000</td>
      <td>8.172054e-05</td>
    </tr>
    <tr>
      <th>38</th>
      <td>RS</td>
      <td>atmosphere</td>
      <td>RS3</td>
      <td>125.000000</td>
      <td>4.562873e-06</td>
    </tr>
    <tr>
      <th>39</th>
      <td>TC</td>
      <td>stormtrack1</td>
      <td>TC1</td>
      <td>40.000000</td>
      <td>2.841439e-04</td>
    </tr>
    <tr>
      <th>40</th>
      <td>TC</td>
      <td>stormtrack2</td>
      <td>TC2</td>
      <td>50.000000</td>
      <td>1.637893e-04</td>
    </tr>
    <tr>
      <th>41</th>
      <td>TC</td>
      <td>stormtrack3</td>
      <td>TC3</td>
      <td>60.000000</td>
      <td>4.064719e-05</td>
    </tr>
    <tr>
      <th>42</th>
      <td>TC</td>
      <td>stormtrack4</td>
      <td>TC4</td>
      <td>60.000000</td>
      <td>4.064719e-05</td>
    </tr>
    <tr>
      <th>43</th>
      <td>TC</td>
      <td>stormtrack5</td>
      <td>TC5</td>
      <td>70.000000</td>
      <td>3.110718e-05</td>
    </tr>
    <tr>
      <th>44</th>
      <td>To</td>
      <td>vortexline1</td>
      <td>To1</td>
      <td>3.000000</td>
      <td>4.537519e-05</td>
    </tr>
    <tr>
      <th>45</th>
      <td>To</td>
      <td>vortexline2</td>
      <td>To2</td>
      <td>3.000000</td>
      <td>4.537519e-05</td>
    </tr>
    <tr>
      <th>46</th>
      <td>To</td>
      <td>vortexline3</td>
      <td>To3</td>
      <td>3.000000</td>
      <td>4.537519e-05</td>
    </tr>
    <tr>
      <th>47</th>
      <td>To</td>
      <td>vortexline4</td>
      <td>To4</td>
      <td>4.000000</td>
      <td>5.712399e-06</td>
    </tr>
    <tr>
      <th>48</th>
      <td>To</td>
      <td>vortexline5</td>
      <td>To5</td>
      <td>4.000000</td>
      <td>5.712399e-06</td>
    </tr>
    <tr>
      <th>49</th>
      <td>To</td>
      <td>vortexline6</td>
      <td>To6</td>
      <td>4.000000</td>
      <td>5.712399e-06</td>
    </tr>
    <tr>
      <th>50</th>
      <td>To</td>
      <td>vortexline7</td>
      <td>To7</td>
      <td>5.000000</td>
      <td>7.191484e-07</td>
    </tr>
    <tr>
      <th>51</th>
      <td>To</td>
      <td>vortexline8</td>
      <td>To8</td>
      <td>5.000000</td>
      <td>7.191484e-07</td>
    </tr>
    <tr>
      <th>52</th>
      <td>To</td>
      <td>vortexline9</td>
      <td>To9</td>
      <td>5.000000</td>
      <td>7.191484e-07</td>
    </tr>
    <tr>
      <th>53</th>
      <td>VE</td>
      <td>volcano1</td>
      <td>VE1</td>
      <td>1.000000</td>
      <td>7.303024e-07</td>
    </tr>
    <tr>
      <th>54</th>
      <td>VE</td>
      <td>volcano1</td>
      <td>VE2</td>
      <td>3.162278</td>
      <td>3.415881e-07</td>
    </tr>
    <tr>
      <th>55</th>
      <td>VE</td>
      <td>volcano1</td>
      <td>VE3</td>
      <td>10.000000</td>
      <td>1.597728e-07</td>
    </tr>
    <tr>
      <th>56</th>
      <td>WF</td>
      <td>forest</td>
      <td>WF1</td>
      <td>10000.000000</td>
      <td>1.062953e-02</td>
    </tr>
    <tr>
      <th>57</th>
      <td>WF</td>
      <td>forest</td>
      <td>WF2</td>
      <td>10000.000000</td>
      <td>1.062953e-02</td>
    </tr>
    <tr>
      <th>58</th>
      <td>WF</td>
      <td>forest</td>
      <td>WF3</td>
      <td>10000.000000</td>
      <td>1.062953e-02</td>
    </tr>
    <tr>
      <th>59</th>
      <td>WF</td>
      <td>forest</td>
      <td>WF4</td>
      <td>10000.000000</td>
      <td>1.062953e-02</td>
    </tr>
    <tr>
      <th>60</th>
      <td>WF</td>
      <td>forest</td>
      <td>WF5</td>
      <td>10000.000000</td>
      <td>1.062953e-02</td>
    </tr>
    <tr>
      <th>61</th>
      <td>WF</td>
      <td>forest</td>
      <td>WF6</td>
      <td>10000.000000</td>
      <td>1.062953e-02</td>
    </tr>
    <tr>
      <th>62</th>
      <td>WF</td>
      <td>forest</td>
      <td>WF7</td>
      <td>31622.776602</td>
      <td>5.158744e-03</td>
    </tr>
    <tr>
      <th>63</th>
      <td>WF</td>
      <td>forest</td>
      <td>WF8</td>
      <td>31622.776602</td>
      <td>5.158744e-03</td>
    </tr>
    <tr>
      <th>64</th>
      <td>WF</td>
      <td>forest</td>
      <td>WF9</td>
      <td>31622.776602</td>
      <td>5.158744e-03</td>
    </tr>
    <tr>
      <th>65</th>
      <td>WF</td>
      <td>forest</td>
      <td>WF10</td>
      <td>100000.000000</td>
      <td>3.755478e-03</td>
    </tr>
    <tr>
      <th>66</th>
      <td>WS</td>
      <td>atmosphere</td>
      <td>WS1</td>
      <td>45.000000</td>
      <td>2.741867e-03</td>
    </tr>
    <tr>
      <th>67</th>
      <td>WS</td>
      <td>atmosphere</td>
      <td>WS2</td>
      <td>50.000000</td>
      <td>1.746819e-05</td>
    </tr>
    <tr>
      <th>68</th>
      <td>CS</td>
      <td>supercell</td>
      <td>CS_toTo1</td>
      <td>13.811900</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>69</th>
      <td>CS</td>
      <td>supercell</td>
      <td>CS_toTo2</td>
      <td>13.811900</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>70</th>
      <td>CS</td>
      <td>supercell</td>
      <td>CS_toTo3</td>
      <td>13.811900</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>71</th>
      <td>CS</td>
      <td>supercell</td>
      <td>CS_toTo4</td>
      <td>13.811900</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>72</th>
      <td>CS</td>
      <td>supercell</td>
      <td>CS_toTo5</td>
      <td>13.811900</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>73</th>
      <td>CS</td>
      <td>supercell</td>
      <td>CS_toTo6</td>
      <td>13.811900</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>74</th>
      <td>CS</td>
      <td>supercell</td>
      <td>CS_toTo7</td>
      <td>13.811900</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>75</th>
      <td>CS</td>
      <td>supercell</td>
      <td>CS_toTo8</td>
      <td>13.811900</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>76</th>
      <td>CS</td>
      <td>supercell</td>
      <td>CS_toTo9</td>
      <td>13.811900</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>77</th>
      <td>FF</td>
      <td>river1</td>
      <td>FF_fromRS1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>78</th>
      <td>FF</td>
      <td>river1</td>
      <td>FF_fromRS2</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>79</th>
      <td>FF</td>
      <td>river1</td>
      <td>FF_fromRS3</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>80</th>
      <td>Li</td>
      <td>supercell</td>
      <td>Li_fromCS1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>81</th>
      <td>Li</td>
      <td>supercell</td>
      <td>Li_fromCS2</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>82</th>
      <td>Li</td>
      <td>supercell</td>
      <td>Li_fromCS3</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>83</th>
      <td>Li</td>
      <td>supercell</td>
      <td>Li_fromCS4</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>84</th>
      <td>Li</td>
      <td>supercell</td>
      <td>Li_fromCS5</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>85</th>
      <td>Li</td>
      <td>supercell</td>
      <td>Li_fromCS6</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>86</th>
      <td>Li</td>
      <td>supercell</td>
      <td>Li_fromCS7</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>87</th>
      <td>Li</td>
      <td>supercell</td>
      <td>Li_fromCS8</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>88</th>
      <td>Li</td>
      <td>supercell</td>
      <td>Li_fromCS9</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>89</th>
      <td>LS</td>
      <td>terrain</td>
      <td>LS_fromRS1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>90</th>
      <td>LS</td>
      <td>terrain</td>
      <td>LS_fromRS2</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>91</th>
      <td>LS</td>
      <td>terrain</td>
      <td>LS_fromRS3</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>92</th>
      <td>SS</td>
      <td>coastline</td>
      <td>SS_fromTC1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>93</th>
      <td>SS</td>
      <td>coastline</td>
      <td>SS_fromTC2</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>94</th>
      <td>SS</td>
      <td>coastline</td>
      <td>SS_fromTC3</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>95</th>
      <td>SS</td>
      <td>coastline</td>
      <td>SS_fromTC4</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>96</th>
      <td>SS</td>
      <td>coastline</td>
      <td>SS_fromTC5</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="from-numerical-models-cellular-automata">
<h4>1.3.2. From numerical models (cellular automata)<a class="headerlink" href="#from-numerical-models-cellular-automata" title="Link to this heading"></a></h4>
<p>Generation of hazard-intensity footprints via dynamical processes (here, cellular automata - CA) is handled separately because these computations are more expensive. This functionality is implemented in the <code class="docutils literal notranslate"><span class="pre">DynamicHazardFootprintGenerator()</span></code> class and applied to the <code class="docutils literal notranslate"><span class="pre">LS</span></code>, <code class="docutils literal notranslate"><span class="pre">FF</span></code> and <code class="docutils literal notranslate"><span class="pre">WF</span></code> perils. Details of the corresponding CA models can be found in the Python file within the <code class="docutils literal notranslate"><span class="pre">CellularAutomaton_*</span></code> classes, where <code class="docutils literal notranslate"><span class="pre">*</span></code> denotes the peril ID.</p>
<p>The following movie illustrates an example of dynamical process. It is produced by running <code class="docutils literal notranslate"><span class="pre">LS_CA.write_gif()</span></code> in the next cell and shows the time-evolving landslide propagation generated by the CA. The final hazard-intensity footprint included in the hazard-footprint catalogue is static and defined as <span class="math notranslate nohighlight">\(\max_t I(x,y,t)\)</span>.</p>
<figure class="align-center" id="mov-ls-ca">
<a class="reference internal image-reference" href="../_images/LS_CA_xrg38_68_yrg20_35.gif"><img alt="../_images/LS_CA_xrg38_68_yrg20_35.gif" src="../_images/LS_CA_xrg38_68_yrg20_35.gif" style="width: 500px;" />
</a>
</figure>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reproduce_LSmovie</span> <span class="o">=</span> <span class="kc">False</span>          <span class="c1"># True to create &#39;movs/LS_CA_xrg38_68_yrg20_35.gif&#39;</span>
<span class="n">reproduce_FFmovie</span> <span class="o">=</span> <span class="kc">False</span>          <span class="c1"># True to create &#39;movs/FF_CA_xrg0_100_yrg0_40.gif&#39;</span>

<span class="k">if</span> <span class="n">reproduce_LSmovie</span><span class="p">:</span>
    <span class="n">movie</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;create&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;xmin&#39;</span><span class="p">:</span> <span class="mi">38</span><span class="p">,</span> <span class="s1">&#39;xmax&#39;</span><span class="p">:</span> <span class="mi">68</span><span class="p">,</span> <span class="s1">&#39;ymin&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;ymax&#39;</span><span class="p">:</span> <span class="mi">35</span><span class="p">}</span>   <span class="c1"># zoom on specific hill</span>

    <span class="n">evID_trigger</span> <span class="o">=</span> <span class="s1">&#39;RS3&#39;</span>                                       <span class="c1"># case considered for movie scenario</span>
    <span class="n">S_trigger</span> <span class="o">=</span> <span class="n">evtable</span><span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">][</span><span class="n">evtable</span><span class="p">[</span><span class="s1">&#39;evID&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">evID_trigger</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">hw</span> <span class="o">=</span> <span class="n">S_trigger</span> <span class="o">*</span> <span class="mf">1e-3</span> <span class="o">*</span> <span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;RS&#39;</span><span class="p">][</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span>          <span class="c1"># water column (m)</span>
    <span class="n">wetness</span> <span class="o">=</span> <span class="n">hw</span> <span class="o">/</span> <span class="n">soilLayer</span><span class="o">.</span><span class="n">h</span>
    <span class="n">wetness</span><span class="p">[</span><span class="n">wetness</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>                                   <span class="c1"># max possible saturation</span>
    <span class="n">wetness</span><span class="p">[</span><span class="n">soilLayer</span><span class="o">.</span><span class="n">h</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>                              <span class="c1"># no soil case</span>

    <span class="n">LS_CA</span> <span class="o">=</span> <span class="n">GenMR_perils</span><span class="o">.</span><span class="n">CellularAutomaton_LS</span><span class="p">(</span><span class="n">soilLayer</span><span class="p">,</span> <span class="n">wetness</span><span class="p">,</span> <span class="n">movie</span><span class="p">)</span>
    <span class="n">LS_CA</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
    <span class="n">LS_CA</span><span class="o">.</span><span class="n">write_gif</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;LS movie created (go to mov/LS_CA_*).&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No LS movie created.&#39;</span><span class="p">)</span>
    
<span class="k">if</span> <span class="n">reproduce_FFmovie</span><span class="p">:</span>
    <span class="n">I_RS</span> <span class="o">=</span> <span class="n">evtable</span><span class="p">[</span><span class="n">evtable</span><span class="p">[</span><span class="s1">&#39;evID&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;RS3&#39;</span><span class="p">][</span><span class="s1">&#39;S&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e-3</span> <span class="o">/</span> <span class="mi">3600</span>    <span class="c1"># (mm/hr) to (m/s)</span>
    <span class="n">movie</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;create&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;xmin&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;xmax&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;ymin&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;ymax&#39;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span> <span class="s1">&#39;tmin&#39;</span><span class="p">:</span> <span class="mi">40</span><span class="p">}</span> 

    <span class="n">FF_CA</span> <span class="o">=</span> <span class="n">GenMR_perils</span><span class="o">.</span><span class="n">CellularAutomaton_FF</span><span class="p">(</span><span class="n">I_RS</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">topoLayer</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">movie</span><span class="p">)</span>
    <span class="n">FF_CA</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
    <span class="n">FF_CA</span><span class="o">.</span><span class="n">write_gif</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;FF movie created (go to mov/FF_CA_*).&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No FF movie created.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No LS movie created.
No FF movie created.
</pre></div>
</div>
</div>
</div>
<p>Footprints are initialised in <code class="docutils literal notranslate"><span class="pre">dynhazFootprints</span></code>, an instance of the <code class="docutils literal notranslate"><span class="pre">DynamicHazardFootprintGenerator()</span></code> class. Running <code class="docutils literal notranslate"><span class="pre">dynhazFootprints.generate()</span></code> computes all dynamical intensity footprints at once. To generate only a specific subset of perils, one must use <code class="docutils literal notranslate"><span class="pre">dynhazFootprints.generate(selected_perils</span> <span class="pre">=</span> <span class="pre">['LS',</span> <span class="pre">'FF',</span> <span class="pre">...])</span></code>. Note that if a peril has already been run, cached footprints will be loaded automatically. To force recomputation, one needs to include the option <code class="docutils literal notranslate"><span class="pre">force_recompute</span> <span class="pre">=</span> <span class="pre">True</span></code> in the class command (or delete the folder <code class="docutils literal notranslate"><span class="pre">*_CA_frames</span></code>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># additional WF source/landuse parameters</span>
<span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;WF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ratio_grass&#39;</span><span class="p">:</span> <span class="mf">.6</span><span class="p">,</span>        <span class="c1"># ratio of forest cells to turn to grass at initial state</span>
             <span class="s1">&#39;p_lightning&#39;</span><span class="p">:</span> <span class="mf">.1</span><span class="p">,</span>            <span class="c1"># probability of lightning strike per iteration</span>
             <span class="s1">&#39;rate_newtrees&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>        <span class="c1"># number of new trees to add per iteration</span>
             <span class="s1">&#39;nsim&#39;</span><span class="p">:</span> <span class="mi">100000</span><span class="p">,</span>               <span class="c1"># number of iterations</span>
             <span class="s1">&#39;Smin_plot&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>            <span class="c1"># minimum WF footprint size to save in &#39;figs/WF_CA_frames&#39;</span>
            <span class="p">}</span>

<span class="n">dynhazFootprints</span> <span class="o">=</span> <span class="n">GenMR_perils</span><span class="o">.</span><span class="n">DynamicHazardFootprintGenerator</span><span class="p">(</span><span class="n">evtable</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">soilLayer</span><span class="p">,</span> <span class="n">urbLandLayer</span><span class="p">)</span>
<span class="n">catalog_dynhazFootprints</span> <span class="o">=</span> <span class="n">dynhazFootprints</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
<span class="c1">#_ = dynhazFootprints.generate(selected_perils = [&#39;LS&#39;], force_recompute = True)</span>
<span class="c1">#catalog_dynhazFootprints = dynhazFootprints.generate(selected_perils = [&#39;FF&#39;], force_recompute = True)</span>
<span class="n">catalog_dynhazFootprints</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>generating footprints for:
Computing potential footprints
0 / 100000
1000 / 100000
2000 / 100000
3000 / 100000
4000 / 100000
5000 / 100000
6000 / 100000
7000 / 100000
8000 / 100000
9000 / 100000
10000 / 100000
11000 / 100000
12000 / 100000
13000 / 100000
14000 / 100000
15000 / 100000
16000 / 100000
17000 / 100000
18000 / 100000
19000 / 100000
20000 / 100000
21000 / 100000
22000 / 100000
23000 / 100000
24000 / 100000
25000 / 100000
26000 / 100000
27000 / 100000
28000 / 100000
29000 / 100000
30000 / 100000
31000 / 100000
32000 / 100000
33000 / 100000
34000 / 100000
35000 / 100000
36000 / 100000
37000 / 100000
38000 / 100000
39000 / 100000
40000 / 100000
41000 / 100000
42000 / 100000
43000 / 100000
44000 / 100000
45000 / 100000
46000 / 100000
47000 / 100000
48000 / 100000
49000 / 100000
50000 / 100000
51000 / 100000
52000 / 100000
53000 / 100000
54000 / 100000
55000 / 100000
56000 / 100000
57000 / 100000
58000 / 100000
59000 / 100000
60000 / 100000
61000 / 100000
62000 / 100000
63000 / 100000
64000 / 100000
65000 / 100000
66000 / 100000
67000 / 100000
68000 / 100000
69000 / 100000
70000 / 100000
71000 / 100000
72000 / 100000
73000 / 100000
74000 / 100000
75000 / 100000
76000 / 100000
77000 / 100000
78000 / 100000
79000 / 100000
80000 / 100000
81000 / 100000
82000 / 100000
83000 / 100000
84000 / 100000
85000 / 100000
86000 / 100000
87000 / 100000
88000 / 100000
89000 / 100000
90000 / 100000
91000 / 100000
92000 / 100000
93000 / 100000
94000 / 100000
95000 / 100000
96000 / 100000
97000 / 100000
98000 / 100000
99000 / 100000
Fetching footprints from potential footprints
WF1 (fetched from cache)
WF2 (fetched from cache)
WF3 (fetched from cache)
WF4 (fetched from cache)
WF5 (fetched from cache)
WF6 (fetched from cache)
WF7 (fetched from cache)
WF8 (fetched from cache)
WF9 (fetched from cache)
WF10 (fetched from cache)
FF_fromRS1 (loaded from cache)
FF_fromRS2 (loaded from cache)
FF_fromRS3 (loaded from cache)
LS_fromRS1 (loaded from cache)
LS_fromRS2 (loaded from cache)
LS_fromRS3 (loaded from cache)
... catalogue completed
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dict_keys([&#39;WF1&#39;, &#39;WF2&#39;, &#39;WF3&#39;, &#39;WF4&#39;, &#39;WF5&#39;, &#39;WF6&#39;, &#39;WF7&#39;, &#39;WF8&#39;, &#39;WF9&#39;, &#39;WF10&#39;, &#39;FF_fromRS1&#39;, &#39;FF_fromRS2&#39;, &#39;FF_fromRS3&#39;, &#39;LS_fromRS1&#39;, &#39;LS_fromRS2&#39;, &#39;LS_fromRS3&#39;])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_Imax</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;LS&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;FF&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;WF&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="n">catalog_dynhazFootprints</span> <span class="o">=</span> <span class="n">dynhazFootprints</span><span class="o">.</span><span class="n">catalog_hazFootprints</span>
<span class="n">GenMR_perils</span><span class="o">.</span><span class="n">plot_hazFootprints</span><span class="p">(</span><span class="n">catalog_dynhazFootprints</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">topoLayer</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">plot_Imax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2ae4ae61a2718dd3e47cf03dde9a8417e73e192a2288145b1d926aed394e99c4.png" src="../_images/2ae4ae61a2718dd3e47cf03dde9a8417e73e192a2288145b1d926aed394e99c4.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># merge the two catalogues</span>
<span class="n">catalog_allhazFootprints</span> <span class="o">=</span> <span class="n">catalog_hazFootprints</span> <span class="o">|</span> <span class="n">catalog_dynhazFootprints</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># bypass dynamic footprints for rapid tests...</span>
<span class="n">catalog_allhazFootprints</span> <span class="o">=</span> <span class="n">catalog_hazFootprints</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="probabilistic-risk-assessment">
<h2>2. Probabilistic risk assessment<a class="headerlink" href="#probabilistic-risk-assessment" title="Link to this heading"></a></h2>
<p>In this final section, loss footprints are modelled, and total losses per event are added as new column in the event table, creating an event loss table (ELT). Risk metrics are then calculated from the ELT (considering only primary events in this tutorial). Year loss tables will be addressed in the future Tutorial 3.</p>
<section id="vulnerability-curve-definition">
<h3>2.1. Vulnerability curve definition<a class="headerlink" href="#vulnerability-curve-definition" title="Link to this heading"></a></h3>
<p>Generic intensity-specific vulnerability functions, <span class="math notranslate nohighlight">\(D = f_D(I)\)</span>, are implemented and apply to any building type for simplicity. The vulnerability functions (<code class="docutils literal notranslate"><span class="pre">f_D()</span></code>) are listed below and correspond to the equations described in Section 3.2.5 of Mignan (2024). Damage is expressed in terms of the mean damage ratio (MDR):</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-left"><p>ID</p></th>
<th class="head text-left"><p>Intensity <span class="math notranslate nohighlight">\(I\)</span></p></th>
<th class="head text-left"><p>Vulnerability function</p></th>
<th class="head text-left"><p>Parameters</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">AI</span></code>, <code class="docutils literal notranslate"><span class="pre">Ex</span></code></p></td>
<td class="text-left"><p>Blast overpressure <span class="math notranslate nohighlight">\(P\)</span> [kPa]</p></td>
<td class="text-left"><p>Cum. lognormal distr. (Eq. 3.13)</p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(\mu\)</span> = log(20), <span class="math notranslate nohighlight">\(\sigma\)</span> = 0.4</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">EQ</span></code></p></td>
<td class="text-left"><p>Peak ground acceleration PGA [m/s<span class="math notranslate nohighlight">\(^2\)</span>]</p></td>
<td class="text-left"><p>Cum. lognormal distr. (Eq. 3.13)</p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(\mu\)</span> = log(6), <span class="math notranslate nohighlight">\(\sigma\)</span> = 0.6</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">FF</span></code>, <code class="docutils literal notranslate"><span class="pre">SS</span></code></p></td>
<td class="text-left"><p>Inundation depth <span class="math notranslate nohighlight">\(h\)</span> [m]</p></td>
<td class="text-left"><p>Square root (Eq. 3.10)</p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(c\)</span> = 0.45</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">LS</span></code></p></td>
<td class="text-left"><p>Landslide thickness <span class="math notranslate nohighlight">\(h\)</span> [m]</p></td>
<td class="text-left"><p>Weibull distr. (Eq. 3.12)</p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(c_1\)</span> = -1.671, <span class="math notranslate nohighlight">\(c_2\)</span> = 3.189, <span class="math notranslate nohighlight">\(c_3\)</span> = 1.746</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">VE</span></code></p></td>
<td class="text-left"><p>Ash load <span class="math notranslate nohighlight">\(P\)</span> [kPa] (converted from thickness [m])</p></td>
<td class="text-left"><p>Cum. lognormal distr. (Eq. 3.13)</p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(\mu\)</span> = 1.6, <span class="math notranslate nohighlight">\(\sigma\)</span> = 0.4</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">TC</span></code>, <code class="docutils literal notranslate"><span class="pre">To</span></code>, <code class="docutils literal notranslate"><span class="pre">WS</span></code></p></td>
<td class="text-left"><p>Maximum wind speed <span class="math notranslate nohighlight">\(v_{max}\)</span> [m/s]</p></td>
<td class="text-left"><p>Power-law (Eq. 3.14)</p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(v_{thres}\)</span> = 25.7, <span class="math notranslate nohighlight">\(v_{half}\)</span> = 74.7</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">WF</span></code></p></td>
<td class="text-left"><p>Burnt yes/no</p></td>
<td class="text-left"><p>Heaviside step function</p></td>
<td class="text-left"><p>MDR = 1 if burnt, 0 otherwise</p></td>
</tr>
</tbody>
</table>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">GenMR_perils</span><span class="o">.</span><span class="n">plot_vulnFunctions</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/fe00f7f82d86a08a4e515f333c74220a7cc2d515387edeef8c6537c95697da57.png" src="../_images/fe00f7f82d86a08a4e515f333c74220a7cc2d515387edeef8c6537c95697da57.png" />
</div>
</div>
</section>
<section id="loss-footprint-catalogue-generation">
<h3>2.2. Loss footprint catalogue generation<a class="headerlink" href="#loss-footprint-catalogue-generation" title="Link to this heading"></a></h3>
<p>Damage footprints, <span class="math notranslate nohighlight">\(D(x,y)\)</span>, are obtained by mapping hazard-intensity footprints, <span class="math notranslate nohighlight">\(I(x,y)\)</span>, into mean damage ratio (MDR) values using the vulnerability functions defined earlier. Loss footprints, <span class="math notranslate nohighlight">\(L(x,y)\)</span>, are calculated as the product of <span class="math notranslate nohighlight">\(D(x,y)\)</span> and the exposure footprint, <span class="math notranslate nohighlight">\(\nu(x,y)\)</span>.</p>
<p>It should be noted that losses are computed for independent events occurring individually. For example, the total loss from a <code class="docutils literal notranslate"><span class="pre">TC</span></code> event could depend on losses caused by the associated <code class="docutils literal notranslate"><span class="pre">SS</span></code> event. Such interactions, whether at the exposure or damage level, will be addressed in Tutorial 3.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">riskFootprints_all</span> <span class="o">=</span> <span class="n">GenMR_perils</span><span class="o">.</span><span class="n">RiskFootprintGenerator</span><span class="p">(</span><span class="n">catalog_allhazFootprints</span><span class="p">,</span> <span class="n">urbLandLayer</span><span class="p">,</span> <span class="n">evtable</span><span class="p">)</span>
<span class="n">catalog_dmgFootprints</span> <span class="o">=</span> <span class="n">riskFootprints_all</span><span class="o">.</span><span class="n">catalog_dmgFootprints</span>
<span class="n">catalog_lossFootprints</span> <span class="o">=</span> <span class="n">riskFootprints_all</span><span class="o">.</span><span class="n">catalog_lossFootprints</span>
<span class="n">riskFootprints_all</span><span class="o">.</span><span class="n">ELT</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Computing MDR &amp; Loss: 100%|| 52/52 [00:01&lt;00:00, 36.00it/s]
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>srcID</th>
      <th>evID</th>
      <th>S</th>
      <th>lbd</th>
      <th>loss</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AI</td>
      <td>impact1</td>
      <td>AI1</td>
      <td>10.0</td>
      <td>0.000013</td>
      <td>3.080122e+00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AI</td>
      <td>impact2</td>
      <td>AI2</td>
      <td>10.0</td>
      <td>0.000013</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AI</td>
      <td>impact3</td>
      <td>AI3</td>
      <td>10.0</td>
      <td>0.000013</td>
      <td>1.816937e-05</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AI</td>
      <td>impact4</td>
      <td>AI4</td>
      <td>100.0</td>
      <td>0.000001</td>
      <td>3.676923e+05</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AI</td>
      <td>impact5</td>
      <td>AI5</td>
      <td>100.0</td>
      <td>0.000001</td>
      <td>6.013396e+09</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>66</th>
      <td>SS</td>
      <td>coastline</td>
      <td>SS_fromTC1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.119423e+09</td>
    </tr>
    <tr>
      <th>67</th>
      <td>SS</td>
      <td>coastline</td>
      <td>SS_fromTC2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.162232e+10</td>
    </tr>
    <tr>
      <th>68</th>
      <td>SS</td>
      <td>coastline</td>
      <td>SS_fromTC3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.891434e+10</td>
    </tr>
    <tr>
      <th>69</th>
      <td>SS</td>
      <td>coastline</td>
      <td>SS_fromTC4</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5.076082e+10</td>
    </tr>
    <tr>
      <th>70</th>
      <td>SS</td>
      <td>coastline</td>
      <td>SS_fromTC5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5.905171e+10</td>
    </tr>
  </tbody>
</table>
<p>71 rows  6 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nfp</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">catalog_lossFootprints</span><span class="p">)</span>
<span class="n">evIDs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">catalog_lossFootprints</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nfp</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">5</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">riskFootprints_all</span><span class="o">.</span><span class="n">ELT</span><span class="p">)))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nfp</span><span class="p">):</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xx</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">yy</span><span class="p">,</span> <span class="n">urbLandLayer</span><span class="o">.</span><span class="n">bldg_value</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;Greens&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xx</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">yy</span><span class="p">,</span> <span class="n">GenMR_env</span><span class="o">.</span><span class="n">ls</span><span class="o">.</span><span class="n">hillshade</span><span class="p">(</span><span class="n">topoLayer</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">vert_exag</span><span class="o">=</span><span class="mf">.1</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">.1</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x$ (km)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y$ (km)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">evIDs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xx</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">yy</span><span class="p">,</span> <span class="n">catalog_dmgFootprints</span><span class="p">[</span><span class="n">evIDs</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;Reds&#39;</span><span class="p">,</span> <span class="n">vmin</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xx</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">yy</span><span class="p">,</span> <span class="n">GenMR_env</span><span class="o">.</span><span class="n">ls</span><span class="o">.</span><span class="n">hillshade</span><span class="p">(</span><span class="n">topoLayer</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">vert_exag</span><span class="o">=</span><span class="mf">.1</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">.1</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x$ (km)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y$ (km)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xx</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">yy</span><span class="p">,</span> <span class="n">catalog_lossFootprints</span><span class="p">[</span><span class="n">evIDs</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;Reds&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xx</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">yy</span><span class="p">,</span> <span class="n">GenMR_env</span><span class="o">.</span><span class="n">ls</span><span class="o">.</span><span class="n">hillshade</span><span class="p">(</span><span class="n">topoLayer</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">vert_exag</span><span class="o">=</span><span class="mf">.1</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">.1</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x$ (km)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y$ (km)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>

<span class="c1"># NB: adapt event size considered and vulnerability to focus on highly damaging events only (illustrative cases)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/27d63e925a63ee6f80ac61328fd4339bf4b0194a61332e0dc65f3fd99113aa9a.png" src="../_images/27d63e925a63ee6f80ac61328fd4339bf4b0194a61332e0dc65f3fd99113aa9a.png" />
</div>
</div>
</section>
<section id="risk-metrics">
<h3>2.3. Risk metrics<a class="headerlink" href="#risk-metrics" title="Link to this heading"></a></h3>
<p>Several risk metrics are derived from the ELT, including the annual average loss (AAL), exceeding probability (EP) curves, value at risk (VaR) at a given quantile <span class="math notranslate nohighlight">\(q\)</span>, and the tail value at risk (TVaR):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q_VAR</span> <span class="o">=</span> <span class="mf">.99</span>
<span class="n">ELT</span> <span class="o">=</span> <span class="n">riskFootprints_all</span><span class="o">.</span><span class="n">ELT</span>
<span class="n">ELT</span><span class="p">[</span><span class="s1">&#39;L&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ELT</span><span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">]</span>
<span class="n">ELT</span> <span class="o">=</span> <span class="n">ELT</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">ELT</span><span class="p">[</span><span class="s1">&#39;lbd&#39;</span><span class="p">])]</span>   <span class="c1"># secondary events (no rate in Tutorial 2 removed)</span>
<span class="n">ELT_wEP</span><span class="p">,</span> <span class="n">AAL</span><span class="p">,</span> <span class="n">VaRq</span><span class="p">,</span> <span class="n">TVaRq</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">GenMR_utils</span><span class="o">.</span><span class="n">calc_riskmetrics_fromELT</span><span class="p">(</span><span class="n">ELT</span><span class="p">,</span> <span class="n">q_VAR</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;** from ELT **&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;AAL [$ M.]:&#39;</span><span class="p">,</span> <span class="n">AAL</span> <span class="o">*</span> <span class="mf">1e-6</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;VaR_q [$ B.]:&#39;</span><span class="p">,</span> <span class="n">VaRq</span> <span class="o">*</span> <span class="mf">1e-9</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;TVaR_q [$ B.]:&#39;</span><span class="p">,</span> <span class="n">TVaRq</span> <span class="o">*</span> <span class="mf">1e-9</span><span class="p">)</span>  <span class="c1"># much higher than VaR due to very long risk tail (default parameterisation)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;20&#39;</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ELT_wEP</span><span class="p">[</span><span class="s1">&#39;L&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e-9</span><span class="p">,</span> <span class="n">ELT_wEP</span><span class="p">[</span><span class="s1">&#39;EP&#39;</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ELT_wEP</span><span class="p">[</span><span class="s1">&#39;L&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e-9</span><span class="p">,</span> <span class="n">ELT_wEP</span><span class="p">[</span><span class="s1">&#39;EP&#39;</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;darkred&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">q_VAR</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dotted&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">VaRq</span> <span class="o">*</span> <span class="mf">1e-9</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dotted&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;darkred&#39;</span><span class="p">)</span>
<span class="c1">#plt.xlim(0,20)</span>
<span class="c1">#plt.ylim(0,.1)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Economic losses [$ B.]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Exceedance probability&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>** from ELT **
AAL [$ M.]: 2678.5205716147916
VaR_q [$ B.]: 67.89485712334694
TVaR_q [$ B.]: 287.23171766165484
</pre></div>
</div>
<img alt="../_images/a87b0af0262c948d360d9039916c33983cfb4d6f8f4d9cfcb9bb29d1d285125e.png" src="../_images/a87b0af0262c948d360d9039916c33983cfb4d6f8f4d9cfcb9bb29d1d285125e.png" />
</div>
</div>
</section>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Mignan A (2024), Introduction to Catastrophe Risk Modelling - A Physics-based Approach. Cambridge University Press, doi: 10.1017/9781009437370</p></li>
</ul>
</section>
<section id="appendix">
<h2>Appendix<a class="headerlink" href="#appendix" title="Link to this heading"></a></h2>
<p>This appendix provides additional details that are kept outside the main notebook to maintain the clarity and flow of the main content.</p>
<section id="a-peril-sources">
<h3>A. Peril sources<a class="headerlink" href="#a-peril-sources" title="Link to this heading"></a></h3>
<center><small><b>Tab. A1.</b> Full list of attributes and properties in source class <code>src</code>.</small></center>
<br>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Attribute</p></th>
<th class="head text-left"><p>ID</p></th>
<th class="head text-left"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>Parameters</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">par</span></code></p></td>
<td class="text-left"><p>Input source parameters</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Spatial grid</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">grid</span></code></p></td>
<td class="text-left"><p>copy of <code class="docutils literal notranslate"><span class="pre">RasterGrid</span></code> class</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>Asteroid impact source characteristics</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">AI_char</span></code></p></td>
<td class="text-left"><p>Stochastic point-source coordinates</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Earthquake source characteristics</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">EQ_char</span></code></p></td>
<td class="text-left"><p>Fault source and segment coordinates, magnitudes and geometries</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>Fluvial flood source characteristics</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">FF_char</span></code></p></td>
<td class="text-left"><p>River bed coordinates</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Storm surge source characteristics</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">SS_char</span></code></p></td>
<td class="text-left"><p>Coastline coordinates</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>Tropical cyclone source characteristics</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">TC_char</span></code></p></td>
<td class="text-left"><p>Stochastic track-source coordinates</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Volcanic eruption source characteristics</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">VE_char</span></code></p></td>
<td class="text-left"><p>Point-source coordinates</p></td>
</tr>
</tbody>
</table>
</section>
<section id="b-stochastic-event-set">
<h3>B. Stochastic event set<a class="headerlink" href="#b-stochastic-event-set" title="Link to this heading"></a></h3>
<section id="b-1-earthquake-case">
<h4>B.1. Earthquake case<a class="headerlink" href="#b-1-earthquake-case" title="Link to this heading"></a></h4>
<p>The coordinates of stochastic events (defined in <code class="docutils literal notranslate"><span class="pre">evchar</span></code>) generally match those of their sources for localised peril sources (for diffuse sources, cellular automata are applied to determine the spatial characteristics of each event). In the case of earthquakes however, a floating rupture approach is used to generate earthquake ruptures on existing fault segments. The next cell illustrates how to extract the relevant information from <code class="docutils literal notranslate"><span class="pre">evchar</span></code> and how to examine the resulting spatial configuration in a stochastic run of <code class="docutils literal notranslate"><span class="pre">EventSetGenerator()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">EQcoord</span> <span class="o">=</span> <span class="n">evchar</span><span class="p">[</span><span class="n">GenMR_perils</span><span class="o">.</span><span class="n">get_peril_evID</span><span class="p">(</span><span class="n">evchar</span><span class="p">[</span><span class="s1">&#39;evID&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="s1">&#39;EQ&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">EQi</span> <span class="o">=</span> <span class="n">evtable</span><span class="p">[</span><span class="n">evtable</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;EQ&#39;</span><span class="p">][</span><span class="s1">&#39;evID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;18&#39;</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">16</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sizeDistr</span><span class="p">[</span><span class="s1">&#39;EQ&#39;</span><span class="p">][</span><span class="s1">&#39;Nstoch&#39;</span><span class="p">]):</span>
    <span class="n">EQcoord_evID</span> <span class="o">=</span> <span class="n">EQcoord</span><span class="p">[</span><span class="n">EQcoord</span><span class="p">[</span><span class="s1">&#39;evID&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">EQi</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xx</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">yy</span><span class="p">,</span> <span class="n">GenMR_env</span><span class="o">.</span><span class="n">ls</span><span class="o">.</span><span class="n">hillshade</span><span class="p">(</span><span class="n">topoLayer</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">vert_exag</span><span class="o">=</span><span class="mf">.1</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">.1</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">EQcoord_evID</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">EQcoord_evID</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;darkred&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">xmax</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">ymin</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">ymax</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x$ (km)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y$ (km)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">EQi</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">pad</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">pause</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>   <span class="c1"># to avoid rare case where plot not displayed on notebook</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/5632b1fefab0d523657fd10397662965fc39c7036a59d131305574e491ae1a75.png" src="../_images/5632b1fefab0d523657fd10397662965fc39c7036a59d131305574e491ae1a75.png" />
</div>
</div>
</section>
<section id="b-2-lightning-case">
<h4>B.2. Lightning case<a class="headerlink" href="#b-2-lightning-case" title="Link to this heading"></a></h4>
<p>Lightning is triggered by convective storms. For a given <code class="docutils literal notranslate"><span class="pre">CS*</span></code> event, the corresponding <code class="docutils literal notranslate"><span class="pre">Li_fromCS*</span></code> event represents a set of lightning strikes, whose occurrence rate depends on the storm size (i.e., the cloud top height) and latitude. As shown below, lightning strikes are sampled from a spatially uniform random distribution within the storm footprint.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">CS_coords</span> <span class="o">=</span> <span class="n">evchar</span><span class="p">[</span><span class="n">evchar</span><span class="p">[</span><span class="s1">&#39;evID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;CS&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">Li_coords</span> <span class="o">=</span> <span class="n">evchar</span><span class="p">[</span><span class="n">evchar</span><span class="p">[</span><span class="s1">&#39;evID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Li&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">CS_list</span> <span class="o">=</span> <span class="n">CS_coords</span><span class="p">[</span><span class="s1">&#39;evID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">Li_list</span> <span class="o">=</span> <span class="n">Li_coords</span><span class="p">[</span><span class="s1">&#39;evID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

<span class="n">n_evID</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">CS_list</span><span class="p">)</span>
<span class="n">max_cols</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">n_evID</span><span class="p">,</span> <span class="n">max_cols</span><span class="p">)</span>
<span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">n_evID</span> <span class="o">/</span> <span class="n">ncols</span><span class="p">))</span>




<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;16&#39;</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">ncols</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">nrows</span><span class="p">),</span> <span class="n">squeeze</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_evID</span><span class="p">):</span>
    <span class="n">CS2plt</span> <span class="o">=</span> <span class="n">CS_coords</span><span class="p">[</span><span class="n">CS_coords</span><span class="p">[</span><span class="s1">&#39;evID&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">CS_list</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">Li2plt</span> <span class="o">=</span> <span class="n">Li_coords</span><span class="p">[</span><span class="n">Li_coords</span><span class="p">[</span><span class="s1">&#39;evID&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">Li_list</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xx</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">yy</span><span class="p">,</span> <span class="n">GenMR_env</span><span class="o">.</span><span class="n">ls</span><span class="o">.</span><span class="n">hillshade</span><span class="p">(</span><span class="n">topoLayer</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">vert_exag</span><span class="o">=</span><span class="mf">.1</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">.1</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">CS2plt</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">CS2plt</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="n">GenMR_utils</span><span class="o">.</span><span class="n">col_peril</span><span class="p">(</span><span class="s1">&#39;CS&#39;</span><span class="p">),</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">Li2plt</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">Li2plt</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="n">GenMR_utils</span><span class="o">.</span><span class="n">col_peril</span><span class="p">(</span><span class="s1">&#39;Li&#39;</span><span class="p">),</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;+&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">xmax</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">ymin</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">ymax</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x$ (km)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y$ (km)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">Li_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">pad</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_evID</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ax</span><span class="p">)):</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/cfd7f2e25ed6264152edaeb8c39c0c5dbf9e4878dc02cd7e3fe7a8d164b4b80d.png" src="../_images/cfd7f2e25ed6264152edaeb8c39c0c5dbf9e4878dc02cd7e3fe7a8d164b4b80d.png" />
</div>
</div>
</section>
<section id="b-3-tornado-case">
<h4>B.3. Tornado case<a class="headerlink" href="#b-3-tornado-case" title="Link to this heading"></a></h4>
<p>Change (e.g., increase) <code class="docutils literal notranslate"><span class="pre">src_test.par['To']['N']</span></code> to test the stochastic properties of the tornado vortex-lines (i.e., initiation points random uniform, random strike, length according to EF-level Beta distribution).</p>
<p>TO IMPROVE: constrain initiation point locations (mask water mass and high altitude).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">src_test</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
<span class="n">src_test</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;To&#39;</span><span class="p">][</span><span class="s1">&#39;N&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">src_test</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;rdm_seed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">sizeDistr_test</span> <span class="o">=</span> <span class="n">sizeDistr</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">sizeDistr_test</span><span class="p">[</span><span class="s1">&#39;To&#39;</span><span class="p">][</span><span class="s1">&#39;Nstoch&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">src_test</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;To&#39;</span><span class="p">][</span><span class="s1">&#39;N&#39;</span><span class="p">]</span>

<span class="n">eventSet_test</span> <span class="o">=</span> <span class="n">GenMR_perils</span><span class="o">.</span><span class="n">EventSetGenerator</span><span class="p">(</span><span class="n">src_test</span><span class="p">,</span> <span class="n">sizeDistr_test</span><span class="p">,</span> <span class="n">GenMR_utils</span><span class="p">)</span>
<span class="n">evtable_test</span><span class="p">,</span> <span class="n">evchar_test</span> <span class="o">=</span> <span class="n">eventSet_test</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>

<span class="n">evchar_To</span> <span class="o">=</span> <span class="n">evchar_test</span><span class="p">[</span><span class="n">evchar_test</span><span class="p">[</span><span class="s1">&#39;evID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;To&#39;</span><span class="p">)]</span>
<span class="n">evIDi</span> <span class="o">=</span> <span class="n">evchar_To</span><span class="p">[</span><span class="s1">&#39;evID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

<span class="n">L3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="n">L4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="n">L5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;16&#39;</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xx</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">yy</span><span class="p">,</span> <span class="n">GenMR_env</span><span class="o">.</span><span class="n">ls</span><span class="o">.</span><span class="n">hillshade</span><span class="p">(</span><span class="n">topoLayer</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">vert_exag</span><span class="o">=</span><span class="mf">.1</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">.1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">evIDi</span><span class="p">:</span>
    <span class="n">indev</span> <span class="o">=</span> <span class="n">evchar_To</span><span class="p">[</span><span class="s1">&#39;evID&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span>
    <span class="n">x_To</span> <span class="o">=</span> <span class="n">evchar_To</span><span class="p">[</span><span class="n">indev</span><span class="p">][</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">y_To</span> <span class="o">=</span> <span class="n">evchar_To</span><span class="p">[</span><span class="n">indev</span><span class="p">][</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">L</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">x_To</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x_To</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y_To</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">y_To</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">evtable_test</span><span class="p">[</span><span class="n">evtable_test</span><span class="p">[</span><span class="s1">&#39;evID&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">][</span><span class="s1">&#39;S&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">col</span> <span class="o">=</span> <span class="s1">&#39;orange&#39;</span>
        <span class="n">L3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">L3</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">evtable_test</span><span class="p">[</span><span class="n">evtable_test</span><span class="p">[</span><span class="s1">&#39;evID&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">][</span><span class="s1">&#39;S&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="n">col</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span>
        <span class="n">L4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">L4</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">col</span> <span class="o">=</span> <span class="s1">&#39;darkred&#39;</span>
        <span class="n">L5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">L5</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_To</span><span class="p">,</span> <span class="n">y_To</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">col</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">xmax</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">ymin</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">ymax</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x$ (km)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y$ (km)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Stochastic vortex lines&#39;</span><span class="p">,</span> <span class="n">pad</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;To&#39;</span><span class="p">][</span><span class="s1">&#39;L_alpha_beta_Lmax_EF3&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">L3</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">bins</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;EF3&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">L4</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">bins</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;EF4&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">L5</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">bins</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;darkred&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;EF5&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Vortex line length (km)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Length distribution&#39;</span><span class="p">,</span> <span class="n">pad</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/1f5779e883b643312b826c9fef9c6378ba0e838f0876edbd62219c0fb1732afa.png" src="../_images/1f5779e883b643312b826c9fef9c6378ba0e838f0876edbd62219c0fb1732afa.png" />
</div>
</div>
</section>
</section>
<section id="c-hazard-footprints">
<h3>C. Hazard footprints<a class="headerlink" href="#c-hazard-footprints" title="Link to this heading"></a></h3>
<section id="c-1-tropical-cyclone-case">
<h4>C.1. Tropical cyclone case<a class="headerlink" href="#c-1-tropical-cyclone-case" title="Link to this heading"></a></h4>
<p>While modelling the <code class="docutils literal notranslate"><span class="pre">AI</span></code>, <code class="docutils literal notranslate"><span class="pre">EQ</span></code>, and <code class="docutils literal notranslate"><span class="pre">VE</span></code> intensity footprints from analytical expressions (Sect. 1.3.1) is straightforward, this is not the case for the <code class="docutils literal notranslate"><span class="pre">TC</span></code> peril, which involves a time-dependent intensity field. First, because the footprint depends on a moving track, a hazard-intensity field must be computed at each time increment, and the final static footprint is then defined as <span class="math notranslate nohighlight">\(\max_t I(x,y,t)\)</span>. Second, the windfield is composed of several components, a tangential wind vector and the storms forward-motion vector, that must be combined to obtain the total wind amplitude. For illustration, intensity footprints at a given instant <span class="math notranslate nohighlight">\(t\)</span> are displayed below, together with their associated windfields, shown both without and with the effect of storm forward motion.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evID</span> <span class="o">=</span> <span class="s1">&#39;TC5&#39;</span>     <span class="c1"># choose a TC event</span>
<span class="n">loc_x</span> <span class="o">=</span> <span class="mf">25.</span>      <span class="c1"># location of time snapshot (km)</span>


<span class="n">track_evID</span> <span class="o">=</span> <span class="n">evchar</span><span class="p">[</span><span class="n">evchar</span><span class="p">[</span><span class="s1">&#39;evID&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">evID</span><span class="p">]</span>
<span class="n">t_snapshot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">track_evID</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">loc_x</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="n">I_sym_t</span><span class="p">,</span> <span class="n">I_asym_t</span><span class="p">,</span> <span class="n">vtot_x</span><span class="p">,</span> <span class="n">vtot_y</span><span class="p">,</span> <span class="n">vtan_x</span><span class="p">,</span> <span class="n">vtan_y</span> <span class="o">=</span> <span class="n">hazFootprints</span><span class="o">.</span><span class="n">get_TC_timeshot</span><span class="p">(</span><span class="n">evID</span><span class="p">,</span> <span class="n">t_snapshot</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;18&#39;</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="n">Imax</span> <span class="o">=</span> <span class="n">plot_Imax</span><span class="p">[</span><span class="s1">&#39;TC&#39;</span><span class="p">]</span>
<span class="n">I_plt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">I_sym_t</span><span class="p">)</span>
<span class="n">I_plt</span><span class="p">[</span><span class="n">I_plt</span> <span class="o">&gt;=</span> <span class="n">Imax</span><span class="p">]</span> <span class="o">=</span> <span class="n">Imax</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xx</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">yy</span><span class="p">,</span> <span class="n">I_plt</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;Reds&#39;</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Imax</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">33</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">Imax</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">track_evID</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">track_evID</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="n">GenMR_utils</span><span class="o">.</span><span class="n">col_peril</span><span class="p">(</span><span class="s1">&#39;TC&#39;</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">SS_char</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">src</span><span class="o">.</span><span class="n">SS_char</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">track_evID</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">t_snapshot</span><span class="p">],</span> <span class="n">track_evID</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">t_snapshot</span><span class="p">],</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> \
              <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">delta</span> <span class="o">=</span> <span class="mi">50</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">delta</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">delta</span><span class="p">)):</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xx</span><span class="p">[</span><span class="n">delta</span><span class="o">*</span><span class="n">i</span><span class="p">,</span><span class="n">delta</span><span class="o">*</span><span class="n">j</span><span class="p">],</span> <span class="n">grid</span><span class="o">.</span><span class="n">yy</span><span class="p">[</span><span class="n">delta</span><span class="o">*</span><span class="n">i</span><span class="p">,</span><span class="n">delta</span><span class="o">*</span><span class="n">j</span><span class="p">],</span> 
            <span class="mf">.05</span> <span class="o">*</span> <span class="n">vtan_x</span><span class="p">[</span><span class="n">delta</span><span class="o">*</span><span class="n">i</span><span class="p">,</span><span class="n">delta</span><span class="o">*</span><span class="n">j</span><span class="p">],</span> <span class="mf">.05</span><span class="o">*</span> <span class="n">vtan_y</span><span class="p">[</span><span class="n">delta</span><span class="o">*</span><span class="n">i</span><span class="p">,</span><span class="n">delta</span><span class="o">*</span><span class="n">j</span><span class="p">],</span> <span class="n">head_width</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x$ (km)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y$ (km)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Static storm&#39;</span><span class="p">,</span> <span class="n">pad</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">xmax</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">ymin</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">ymax</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">I_plt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">I_asym_t</span><span class="p">)</span>
<span class="n">I_plt</span><span class="p">[</span><span class="n">I_plt</span> <span class="o">&gt;=</span> <span class="n">Imax</span><span class="p">]</span> <span class="o">=</span> <span class="n">Imax</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xx</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">yy</span><span class="p">,</span> <span class="n">I_plt</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;Reds&#39;</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Imax</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">33</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">Imax</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">track_evID</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">track_evID</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="n">GenMR_utils</span><span class="o">.</span><span class="n">col_peril</span><span class="p">(</span><span class="s1">&#39;TC&#39;</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">SS_char</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">src</span><span class="o">.</span><span class="n">SS_char</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">track_evID</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">t_snapshot</span><span class="p">],</span> <span class="n">track_evID</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">t_snapshot</span><span class="p">],</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> \
              <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">delta</span> <span class="o">=</span> <span class="mi">50</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">delta</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">delta</span><span class="p">)):</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xx</span><span class="p">[</span><span class="n">delta</span><span class="o">*</span><span class="n">i</span><span class="p">,</span><span class="n">delta</span><span class="o">*</span><span class="n">j</span><span class="p">],</span> <span class="n">grid</span><span class="o">.</span><span class="n">yy</span><span class="p">[</span><span class="n">delta</span><span class="o">*</span><span class="n">i</span><span class="p">,</span><span class="n">delta</span><span class="o">*</span><span class="n">j</span><span class="p">],</span> 
            <span class="mf">.05</span> <span class="o">*</span> <span class="n">vtot_x</span><span class="p">[</span><span class="n">delta</span><span class="o">*</span><span class="n">i</span><span class="p">,</span><span class="n">delta</span><span class="o">*</span><span class="n">j</span><span class="p">],</span> <span class="mf">.05</span><span class="o">*</span> <span class="n">vtot_y</span><span class="p">[</span><span class="n">delta</span><span class="o">*</span><span class="n">i</span><span class="p">,</span><span class="n">delta</span><span class="o">*</span><span class="n">j</span><span class="p">],</span> <span class="n">head_width</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x$ (km)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y$ (km)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Storm in motion&#39;</span><span class="p">,</span> <span class="n">pad</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">xmax</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">ymin</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">ymax</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/dd1cc1805757ff84ff9799422d0370ebdff64cc8770d03f4f3b1788bd2788973.png" src="../_images/dd1cc1805757ff84ff9799422d0370ebdff64cc8770d03f4f3b1788bd2788973.png" />
</div>
</div>
</section>
<section id="c-2-tornado-case">
<h4>C.2. Tornado case<a class="headerlink" href="#c-2-tornado-case" title="Link to this heading"></a></h4>
<p>Since tornado intensity footprints appear as linear features at the digital template scale, the following cell zooms into a segment of a maximum wind-speed footprint to illustrate the lateral asymmetry of the wind field perpendicular to the source line.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evID</span> <span class="o">=</span> <span class="s1">&#39;To1&#39;</span>

<span class="n">To_coord</span> <span class="o">=</span> <span class="n">evchar</span><span class="p">[</span><span class="n">evchar</span><span class="p">[</span><span class="s1">&#39;evID&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">evID</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">vmax</span> <span class="o">=</span> <span class="n">catalog_hazFootprints</span><span class="p">[</span><span class="n">evID</span><span class="p">]</span>
<span class="c1"># add signed lateral distance</span>
<span class="n">r2To</span> <span class="o">=</span> <span class="n">GenMR_perils</span><span class="o">.</span><span class="n">HazardFootprintGenerator</span><span class="o">.</span><span class="n">calc_lateral_distance_signed</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xx</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">yy</span><span class="p">,</span> <span class="n">To_coord</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">To_coord</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>


<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;18&#39;</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xx</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">yy</span><span class="p">,</span> <span class="n">r2To</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;seismic&#39;</span><span class="p">,</span> <span class="n">vmin</span> <span class="o">=</span> <span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">201</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xx</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">yy</span><span class="p">,</span> <span class="n">GenMR_env</span><span class="o">.</span><span class="n">ls</span><span class="o">.</span><span class="n">hillshade</span><span class="p">(</span><span class="n">topoLayer</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">vert_exag</span><span class="o">=</span><span class="mf">.1</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">.1</span><span class="p">)</span>
<span class="n">dx</span> <span class="o">=</span> <span class="n">To_coord</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">To_coord</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">dy</span> <span class="o">=</span> <span class="n">To_coord</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">To_coord</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">To_coord</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">To_coord</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">head_width</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">xmax</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">ymin</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">ymax</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x$ (km)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y$ (km)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Signed lateral dist. to path&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xx</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">yy</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;Reds&#39;</span><span class="p">,</span> <span class="n">vmin</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="mi">80</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xx</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">yy</span><span class="p">,</span> <span class="n">GenMR_env</span><span class="o">.</span><span class="n">ls</span><span class="o">.</span><span class="n">hillshade</span><span class="p">(</span><span class="n">topoLayer</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">vert_exag</span><span class="o">=</span><span class="mf">.1</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">.1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">xmax</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">ymin</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">ymax</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x$ (km)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y$ (km)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">evID</span><span class="si">}</span><span class="s1"> footprint&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">To_x0</span><span class="p">,</span> <span class="n">To_y0</span> <span class="o">=</span> <span class="n">To_coord</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">To_coord</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">dxy</span> <span class="o">=</span> <span class="mf">1.</span>  <span class="c1"># km on each side of (x0,y0)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xx</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">yy</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;Reds&#39;</span><span class="p">,</span> <span class="n">vmin</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="mi">80</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xx</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">yy</span><span class="p">,</span> <span class="n">GenMR_env</span><span class="o">.</span><span class="n">ls</span><span class="o">.</span><span class="n">hillshade</span><span class="p">(</span><span class="n">topoLayer</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">vert_exag</span><span class="o">=</span><span class="mf">.1</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">.1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">To_coord</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">To_coord</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dotted&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">To_x0</span><span class="o">-</span><span class="n">dxy</span><span class="p">,</span> <span class="n">To_x0</span><span class="o">+</span><span class="n">dxy</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">To_y0</span><span class="o">-</span><span class="n">dxy</span><span class="p">,</span> <span class="n">To_y0</span><span class="o">+</span><span class="n">dxy</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x$ (km)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y$ (km)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">evID</span><span class="si">}</span><span class="s1"> footprint zoomed in&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4c6b5c4e6d2d22437561097dec4c0e3e0dcd52835b20b8b379660005ffce315e.png" src="../_images/4c6b5c4e6d2d22437561097dec4c0e3e0dcd52835b20b8b379660005ffce315e.png" />
</div>
</div>
</section>
<section id="c-3-heatwave-case-threshold-model">
<h4>C.3. Heatwave case (threshold model)<a class="headerlink" href="#c-3-heatwave-case-threshold-model" title="Link to this heading"></a></h4>
<p>Heatwave <code class="docutils literal notranslate"><span class="pre">HW</span></code> temperature footprints are generated using a threshold-based model, in which an event is declared when the temperature equals or exceeds <code class="docutils literal notranslate"><span class="pre">T_th</span></code> for at least <code class="docutils literal notranslate"><span class="pre">Dt_da</span></code> consecutive days. Temperature extremes in the digital template arise from the combination of large-scale advective temperature anomalies and temporally correlated daily temperature variability.</p>
<p>The parameter <code class="docutils literal notranslate"><span class="pre">nsig</span></code> can be adjusted to explore different levels of heatwave extremity within the digital template.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">norm</span>

<span class="n">nsig</span> <span class="o">=</span> <span class="mi">3</span>                                       <span class="c1"># mean temperature extreme observed at nsigma</span>
<span class="n">rdm_seed</span> <span class="o">=</span> <span class="mi">4</span>                                   <span class="c1"># None or integer - to test different daily fluctuations</span>
<span class="n">Tmin</span><span class="p">,</span> <span class="n">Tmax</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">40</span>                            <span class="c1"># range considered</span>


<span class="n">T_th</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;HW&#39;</span><span class="p">][</span><span class="s1">&#39;T_th&#39;</span><span class="p">]</span>
<span class="n">Dt</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;HW&#39;</span><span class="p">][</span><span class="s1">&#39;Dt_da&#39;</span><span class="p">]</span>
<span class="n">sigmaT_yearly</span> <span class="o">=</span><span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;HW&#39;</span><span class="p">][</span><span class="s1">&#39;sigmaT_yearly&#39;</span><span class="p">]</span>
<span class="n">sigmaT_daily</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;HW&#39;</span><span class="p">][</span><span class="s1">&#39;sigmaT_daily&#39;</span><span class="p">]</span>
<span class="n">corrT</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;HW&#39;</span><span class="p">][</span><span class="s1">&#39;corrT&#39;</span><span class="p">]</span>
<span class="n">Ndays</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;HW&#39;</span><span class="p">][</span><span class="s1">&#39;Dt_max_da&#39;</span><span class="p">]</span>
<span class="n">dayi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;HW&#39;</span><span class="p">][</span><span class="s1">&#39;Dt_max_da&#39;</span><span class="p">])</span><span class="o">+</span><span class="mi">1</span>
<span class="n">lat</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;lat_deg&#39;</span><span class="p">]</span>

<span class="n">Ti</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">Tmin</span><span class="p">,</span> <span class="n">Tmax</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">T0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">atmoLayer</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>                       <span class="c1"># digital template near-surface air temperature f(lat, month)</span>
<span class="n">Tnorm_pdf</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">Ti</span><span class="p">,</span> <span class="n">T0</span><span class="p">,</span> <span class="n">sigmaT_yearly</span><span class="p">)</span>    <span class="c1"># annual variations of mean temperature</span>

<span class="c1"># advection model (3-Gaussian model)</span>
<span class="n">Tadv_pdf</span><span class="p">,</span> <span class="n">Tadv_sigma</span><span class="p">,</span> <span class="n">advection_comp</span> <span class="o">=</span> <span class="n">GenMR_perils</span><span class="o">.</span><span class="n">HazardFootprintGenerator</span><span class="o">.</span><span class="n">pdf_T_advectivemodel</span><span class="p">(</span><span class="n">Ti</span><span class="p">,</span> <span class="n">T0</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>

<span class="n">Tadv_nsig</span> <span class="o">=</span> <span class="n">T0</span> <span class="o">+</span> <span class="n">nsig</span> <span class="o">*</span> <span class="n">Tadv_sigma</span>             <span class="c1"># nsigma advective event</span>
                                               <span class="c1"># note: the stochastic version also includes sigmaT_yearly role</span>
<span class="c1"># temperature daily variations over Ndays</span>
<span class="n">Tdaily_stoch_nsig</span> <span class="o">=</span> <span class="n">GenMR_perils</span><span class="o">.</span><span class="n">HazardFootprintGenerator</span><span class="o">.</span><span class="n">sample_T_daily</span><span class="p">(</span><span class="n">Tadv_nsig</span><span class="p">,</span> \
                                 <span class="n">sigmaT_daily</span><span class="p">,</span> <span class="n">Ndays</span> <span class="o">=</span> <span class="n">Ndays</span><span class="p">,</span> <span class="n">rho</span> <span class="o">=</span> <span class="n">corrT</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">rdm_seed</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;T0=</span><span class="si">{</span><span class="n">T0</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">C, </span><span class="si">{</span><span class="n">nsig</span><span class="si">}</span><span class="s1">sigma=</span><span class="si">{</span><span class="n">Tadv_nsig</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">C, daily max=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">Tdaily_stoch_nsig</span><span class="p">)</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">C&#39;</span><span class="p">)</span>

<span class="c1"># extract heatwave events according to time series only (loc where T = Tdaily_stoch_nsig)</span>
<span class="n">HW_ti_nsig</span><span class="p">,</span> <span class="n">HW_Dt_nsig</span> <span class="o">=</span> <span class="n">GenMR_perils</span><span class="o">.</span><span class="n">HazardFootprintGenerator</span><span class="o">.</span><span class="n">get_HW_atloc</span><span class="p">(</span><span class="n">Tdaily_stoch_nsig</span><span class="p">,</span> <span class="n">T_th</span><span class="p">,</span> <span class="n">Dt</span><span class="p">)</span>

<span class="c1"># define nsigma HW footprint</span>
<span class="n">DTadv_nsig</span> <span class="o">=</span> <span class="n">Tadv_nsig</span> <span class="o">-</span> <span class="n">T0</span>                    <span class="c1"># advection shift</span>
<span class="n">Tmap_mean</span> <span class="o">=</span> <span class="n">atmoLayer</span><span class="o">.</span><span class="n">T</span> <span class="o">+</span> <span class="n">DTadv_nsig</span>           <span class="c1"># mean temperature map of the nsigma day, before daily fluctuations</span>
<span class="n">DTdaily_stoch</span> <span class="o">=</span> <span class="n">Tdaily_stoch_nsig</span> <span class="o">-</span> <span class="n">Tadv_nsig</span>  <span class="c1"># daily fluctuations</span>

<span class="n">nx</span><span class="p">,</span> <span class="n">ny</span> <span class="o">=</span> <span class="n">Tmap_mean</span><span class="o">.</span><span class="n">shape</span>
<span class="n">Tmap_daily_stoch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">Ndays</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">))</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Ndays</span><span class="p">):</span>
     <span class="n">Tmap_daily_stoch</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tmap_mean</span> <span class="o">+</span> <span class="n">DTdaily_stoch</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
<span class="n">HW_fp</span><span class="p">,</span> <span class="n">HW_S</span> <span class="o">=</span> <span class="n">GenMR_perils</span><span class="o">.</span><span class="n">HazardFootprintGenerator</span><span class="o">.</span><span class="n">get_HW_footprint</span><span class="p">(</span><span class="n">Tmap_daily_stoch</span><span class="p">,</span> <span class="n">Tth</span><span class="o">=</span><span class="n">T_th</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;16&#39;</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xx</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">yy</span><span class="p">,</span> <span class="n">GenMR_env</span><span class="o">.</span><span class="n">ls</span><span class="o">.</span><span class="n">hillshade</span><span class="p">(</span><span class="n">topoLayer</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">vert_exag</span><span class="o">=</span><span class="mf">.1</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xx</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">yy</span><span class="p">,</span> <span class="n">atmoLayer</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;bwr&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">.5</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x$ (km)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y$ (km)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Average temperature&#39;</span><span class="p">,</span> <span class="n">pad</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">fraction</span> <span class="o">=</span> <span class="mf">.04</span><span class="p">,</span> <span class="n">pad</span> <span class="o">=</span> <span class="mf">.04</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Temperature (C)&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xx</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">yy</span><span class="p">,</span> <span class="n">GenMR_env</span><span class="o">.</span><span class="n">ls</span><span class="o">.</span><span class="n">hillshade</span><span class="p">(</span><span class="n">topoLayer</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">vert_exag</span><span class="o">=</span><span class="mf">.1</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xx</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">yy</span><span class="p">,</span> <span class="n">atmoLayer</span><span class="o">.</span><span class="n">T</span> <span class="o">+</span> <span class="n">nsig</span> <span class="o">*</span> <span class="n">Tadv_sigma</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;bwr&#39;</span><span class="p">,</span> \
                 <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">.5</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x$ (km)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y$ (km)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Advection temp. at </span><span class="si">{</span><span class="n">nsig</span><span class="si">}</span><span class="s1">$\sigma$&#39;</span><span class="p">,</span> <span class="n">pad</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">fraction</span> <span class="o">=</span> <span class="mf">.04</span><span class="p">,</span> <span class="n">pad</span> <span class="o">=</span> <span class="mf">.04</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Temperature (C)&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xx</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">yy</span><span class="p">,</span> <span class="n">GenMR_env</span><span class="o">.</span><span class="n">ls</span><span class="o">.</span><span class="n">hillshade</span><span class="p">(</span><span class="n">topoLayer</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">vert_exag</span><span class="o">=</span><span class="mf">.1</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xx</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">yy</span><span class="p">,</span> <span class="n">atmoLayer</span><span class="o">.</span><span class="n">T</span> <span class="o">+</span> <span class="n">DTadv_nsig</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">DTdaily_stoch</span><span class="p">),</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;bwr&#39;</span><span class="p">,</span> \
                 <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">.5</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x$ (km)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y$ (km)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Max. daily temp. at </span><span class="si">{</span><span class="n">nsig</span><span class="si">}</span><span class="s1">$\sigma$&#39;</span><span class="p">,</span> <span class="n">pad</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">fraction</span> <span class="o">=</span> <span class="mf">.04</span><span class="p">,</span> <span class="n">pad</span> <span class="o">=</span> <span class="mf">.04</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Temperature (C)&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>


<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Ti</span><span class="p">,</span> <span class="n">Tnorm_pdf</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">T0</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;$T_0$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">T0</span> <span class="o">+</span> <span class="n">nsig</span> <span class="o">*</span> <span class="n">sigmaT_yearly</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dotted&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;$T_0+</span><span class="si">{</span><span class="n">nsig</span><span class="si">}</span><span class="s1">\sigma$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">T_th</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;darkred&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;$T_</span><span class="si">{th}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$T$ (C)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Baseline&#39;</span><span class="p">,</span> <span class="n">pad</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Ti</span><span class="p">,</span> <span class="n">advection_comp</span><span class="p">[</span><span class="s1">&#39;pdf0&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;baseline&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Ti</span><span class="p">,</span> <span class="n">advection_comp</span><span class="p">[</span><span class="s1">&#39;pdf_c&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;cold flux&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Ti</span><span class="p">,</span> <span class="n">advection_comp</span><span class="p">[</span><span class="s1">&#39;pdf_w&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;warm flux&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Ti</span><span class="p">,</span> <span class="n">Tadv_pdf</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">T0</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">Tadv_nsig</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dotted&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">T_th</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;darkred&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$T$ (C)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Advection&#39;</span><span class="p">,</span> <span class="n">pad</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>

<span class="n">dayi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">Ndays</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dayi</span><span class="p">,</span> <span class="n">Tdaily_stoch_nsig</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">HW_ti_nsig</span><span class="p">:</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span><span class="n">dayi</span><span class="p">[</span><span class="n">start</span><span class="p">]</span> <span class="o">-</span> <span class="mf">.5</span><span class="p">,</span> <span class="n">dayi</span><span class="p">[</span><span class="n">end</span><span class="p">]</span> <span class="o">+</span> <span class="mf">.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkred&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">.2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">Tadv_nsig</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dotted&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">T_th</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;darkred&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">T_th</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="n">T_th</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Day of the month&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$T$ (C)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Daily temp. at +</span><span class="si">{</span><span class="n">nsig</span><span class="si">}</span><span class="s1">$\sigma$=</span><span class="si">{</span><span class="n">Tadv_nsig</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">C&#39;</span><span class="p">,</span> <span class="n">pad</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xx</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">yy</span><span class="p">,</span> <span class="n">GenMR_env</span><span class="o">.</span><span class="n">ls</span><span class="o">.</span><span class="n">hillshade</span><span class="p">(</span><span class="n">topoLayer</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">vert_exag</span><span class="o">=</span><span class="mf">.1</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">xx</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">yy</span><span class="p">,</span> <span class="n">HW_fp</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;Reds&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">.5</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x$ (km)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y$ (km)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">nsig</span><span class="si">}</span><span class="s1">$\sigma$ heatwave fp. (</span><span class="si">{</span><span class="n">HW_S</span><span class="si">}</span><span class="s1"> da)&#39;</span><span class="p">,</span> <span class="n">pad</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>T0=24.4C, 3sigma=34.3C, daily max=37.8C
</pre></div>
</div>
<img alt="../_images/89ae7c334f7bf259e07aaec23176d92ebaa719d870eaaba82179dd2ae6841db6.png" src="../_images/89ae7c334f7bf259e07aaec23176d92ebaa719d870eaaba82179dd2ae6841db6.png" />
</div>
</div>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Tutorial1_DigitalTemplate_environment.html" class="btn btn-neutral float-left" title="Tutorial 1: Generating a virtual environment for the GenMR digital template" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Arnaud Mignan.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>